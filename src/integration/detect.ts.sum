---
generated_at: 2026-02-09T21:29:23.776Z
content_hash: f2c64d262c35364a46b10b33f9d740d89cb81adccc17d12081bd23269592cea1
purpose: detectEnvironments() discovers AI coding assistant installations by checking for Claude Code (`.claude/` or `CLAUDE.m...
---
**detectEnvironments() discovers AI coding assistant installations by checking for Claude Code (`.claude/` or `CLAUDE.md`), OpenCode (`.opencode/`), and Aider (`.aider.conf.yml` or `.aider/`) configuration artifacts.**

## Exported Functions

`detectEnvironments(projectRoot: string): DetectedEnvironment[]` returns array of detected AI assistant environments by testing existence of configuration directories and files via `existsSync()`. Checks Claude Code markers (`.claude` directory OR `CLAUDE.md` file), OpenCode marker (`.opencode` directory), and Aider markers (`.aider.conf.yml` file OR `.aider` directory). Each detected environment produces `DetectedEnvironment` object with `type`, `configDir`, and `detected: true` properties.

`hasEnvironment(projectRoot: string, type: EnvironmentType): boolean` returns true if specified environment type exists in project root. Delegates to `detectEnvironments()` and tests result array via `some()` predicate matching `env.type === type`.

## Detection Logic

Claude detection uses dual-path OR logic: `.claude/` directory existence OR `CLAUDE.md` file existence both trigger detection with `configDir: '.claude'` in result. OpenCode requires `.opencode/` directory existence. Aider uses dual-path OR logic: `.aider.conf.yml` file existence OR `.aider/` directory existence both trigger detection with `configDir: '.aider'` in result.

## Path Resolution

All checks use `path.join(projectRoot, relativePath)` for absolute path construction passed to `existsSync()`. No recursive traversal or parent directory scanningâ€”only direct children of `projectRoot` tested.

## Type Dependencies

Imports `DetectedEnvironment` interface and `EnvironmentType` union type from `./types.js`. `EnvironmentType` expected to constrain values `'claude' | 'opencode' | 'aider'` based on detection logic branches.