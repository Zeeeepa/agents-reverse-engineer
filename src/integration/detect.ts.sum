---
generated_at: 2026-02-09T14:09:17.811Z
content_hash: f2c64d262c35364a46b10b33f9d740d89cb81adccc17d12081bd23269592cea1
purpose: Detects AI coding assistant environments (Claude Code, OpenCode, Aider) in project directories by checking for config...
---
**Detects AI coding assistant environments (Claude Code, OpenCode, Aider) in project directories by checking for configuration directories and files.**

## Exported Functions

`detectEnvironments(projectRoot: string): DetectedEnvironment[]` scans `projectRoot` for AI assistant configuration artifacts and returns array of detected environments. Detection logic:
- Claude Code: checks `existsSync('.claude/')` OR `existsSync('CLAUDE.md')`
- OpenCode: checks `existsSync('.opencode/')`
- Aider: checks `existsSync('.aider.conf.yml')` OR `existsSync('.aider/')`

Returns `DetectedEnvironment[]` with `{ type: EnvironmentType, configDir: string, detected: true }` for each match.

`hasEnvironment(projectRoot: string, type: EnvironmentType): boolean` convenience predicate wrapping `detectEnvironments()` with `Array.some()` filter for specific `type` ('claude' | 'opencode' | 'aider').

## Type Dependencies

Imports `DetectedEnvironment` and `EnvironmentType` from `./types.js`. `DetectedEnvironment` structure: `{ type, configDir, detected }`. `EnvironmentType` union: `'claude' | 'opencode' | 'aider'`.

## Detection Strategy

Uses filesystem probing via `existsSync()` with `path.join(projectRoot, relativePath)` for each artifact. Multiple detection paths per environment support different installation patterns (e.g., Claude Code detects both `.claude/` directory for commands/hooks and `CLAUDE.md` standalone file). Accumulates matches into mutable `environments: DetectedEnvironment[]` array with explicit `type` tagging.

## Integration Context

Part of `src/integration/` module providing platform-specific template generation. Enables conditional logic for installer (`src/installer/`) to determine which AI assistant commands/hooks to provision. Detection results feed `src/integration/generate.ts` for producing runtime-appropriate command/hook files.