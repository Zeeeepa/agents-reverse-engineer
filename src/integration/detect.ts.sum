---
generated_at: 2026-02-09T17:45:18.937Z
content_hash: f2c64d262c35364a46b10b33f9d740d89cb81adccc17d12081bd23269592cea1
purpose: detectEnvironments() and hasEnvironment() identify which AI coding assistant environments (Claude Code, OpenCode, Aid...
---
**detectEnvironments() and hasEnvironment() identify which AI coding assistant environments (Claude Code, OpenCode, Aider) exist in a project by checking for their configuration directories and marker files.**

## Exported Functions

**detectEnvironments(projectRoot: string): DetectedEnvironment[]**
Returns array of all detected AI assistant environments in the given project root. Checks for Claude Code (`.claude/` directory OR `CLAUDE.md` file), OpenCode (`.opencode/` directory), and Aider (`.aider.conf.yml` file OR `.aider/` directory). Returns `DetectedEnvironment[]` with `type`, `configDir`, and `detected: true` fields.

**hasEnvironment(projectRoot: string, type: EnvironmentType): boolean**
Returns true if the specified `EnvironmentType` ('claude' | 'opencode' | 'aider') is present in the project. Delegates to `detectEnvironments()` and filters results.

## Detection Logic

detectEnvironments() uses `existsSync()` from `node:fs` to check for:
- **Claude Code**: `path.join(projectRoot, '.claude')` OR `path.join(projectRoot, 'CLAUDE.md')`
- **OpenCode**: `path.join(projectRoot, '.opencode')`
- **Aider**: `path.join(projectRoot, '.aider.conf.yml')` OR `path.join(projectRoot, '.aider')`

All detected environments return `configDir` values: `'.claude'`, `'.opencode'`, or `'.aider'`.

## Type Imports

Imports `DetectedEnvironment` and `EnvironmentType` from `./types.js`. `EnvironmentType` discriminates the `type` field returned in detection results.