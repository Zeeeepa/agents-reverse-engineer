---
generated_at: 2026-02-09T16:10:39.087Z
content_hash: 807d633ab0a3f34ba82995ad8707fd0c6baf723f73c6eedbd50258b6fbe3725c
purpose: Orchestrates npx installation workflow for IDE command/hook registration with runtime-specific path resolution, inter...
---
**Orchestrates npx installation workflow for IDE command/hook registration with runtime-specific path resolution, interactive prompts for missing parameters, and parallel support for Claude Code, OpenCode, and Gemini backends.**

## Exported Functions

**`runInstaller(args: InstallerArgs): Promise<InstallerResult[]>`** — Main entry point executing install/uninstall workflow with location determination, runtime selection, file operations via `installFiles()`/`uninstallFiles()`, verification via `verifyInstallation()`, and styled output formatting. Returns empty array if `args.help` is true. Exits with code 1 in non-interactive mode when `--runtime` or location flags missing.

**`parseInstallerArgs(args: string[]): InstallerArgs`** — Parses CLI arguments supporting short flags (`-g`, `-l`, `-h`, `-q`) and long flags (`--global`, `--local`, `--force`, `--quiet`, `--help`), extracts `--runtime` value with validation against `validRuntimes: Runtime[] = ['claude', 'opencode', 'gemini', 'all']`, returns `InstallerArgs` with boolean flags and optional `runtime` field.

## Re-exported Symbols

Exports types from `./types.js`: `InstallerArgs`, `InstallerResult`, `Runtime`, `Location`, `RuntimePaths`

Exports functions from module dependencies:
- `./paths.js`: `getRuntimePaths`, `getAllRuntimes`, `resolveInstallPath`, `getSettingsPath`
- `./banner.js`: `displayBanner`, `showHelp`, `showSuccess`, `showError`, `showWarning`, `showInfo`, `showNextSteps`, `VERSION`
- `./prompts.js`: `selectRuntime`, `selectLocation`, `confirmAction`, `isInteractive`

## Internal Workflow Functions

**`determineLocation(args: InstallerArgs): Location | undefined`** — Returns `'global'` if `args.global && !args.local`, returns `'local'` if `args.local && !args.global`, returns `undefined` (triggers interactive prompt) if both or neither flags set.

**`determineRuntimes(runtime: Runtime | undefined): Array<Exclude<Runtime, 'all'>>`** — Returns empty array if `runtime` is undefined (triggers prompt), calls `getAllRuntimes()` if `runtime === 'all'`, otherwise returns single-element array with specific runtime.

**`runInstall(runtime: Runtime, location: Location, force: boolean, quiet: boolean): Promise<InstallerResult[]>`** — Executes installation by calling `installFiles(runtime, location, { force, dryRun: false })`, flattens `results.flatMap((r) => r.filesCreated)` for verification input, calls `verifyInstallation(allCreatedFiles)`, logs errors for missing files via `verification.missing`, invokes `displayInstallResults(results)` unless `quiet` is true.

**`runUninstall(runtime: Runtime, location: Location, quiet: boolean): InstallerResult[]`** — Executes uninstallation by calling `uninstallFiles(runtime, location, false)`, calls `deleteConfigFolder(location, false)` returning `configDeleted` boolean, invokes `displayUninstallResults(results, configDeleted)` unless `quiet` is true.

## Display Functions

**`displayInstallResults(results: InstallerResult[]): void`** — Iterates over results accumulating `totalCreated`, `totalSkipped`, `hooksRegistered` counters, calls `showSuccess()`/`showError()` per result, displays summary with `showSuccess()` for created files and registered hooks, calls `showWarning()` for skipped files with `--force` hint, invokes `showNextSteps(primaryRuntime, totalCreated)` where `primaryRuntime = results[0]?.runtime || 'claude'`, outputs GitHub docs link via `showInfo('Docs: https://github.com/GeoloeG-IsT/agents-reverse-engineer')`.

**`displayUninstallResults(results: InstallerResult[], configDeleted: boolean = false): void`** — Iterates results tracking `totalDeleted` (from `result.filesCreated.length` repurposed for deleted files), `hooksUnregistered` (from `result.hookRegistered` repurposed for unregister count), calls `showSuccess()` for non-zero deletions, `showInfo()` when no files found, displays summary with removal counts and config folder deletion status.

## Non-Interactive Mode Constraints

Requires `--runtime` flag with validated value (`'claude'` | `'opencode'` | `'gemini'` | `'all'`), requires `-g`/`--global` or `-l`/`--local` flag, calls `showError()` and `process.exit(1)` if either missing when `!isInteractive()`, skips prompts entirely in non-interactive context.

## Integration Points

Depends on `./operations.js` for `installFiles()`, `verifyInstallation()`, `formatInstallResult()`, depends on `./uninstall.js` for `uninstallFiles()`, `deleteConfigFolder()`, depends on `./prompts.js` for `selectRuntime()`, `selectLocation()`, `isInteractive()` interactive mode detection, depends on `./banner.js` for all styled terminal output functions, depends on `./paths.js` for `getAllRuntimes()` and `resolveInstallPath()`.

## Runtime Type Definition

Type `Runtime = 'claude' | 'opencode' | 'gemini' | 'all'` validated in `parseInstallerArgs()` via `validRuntimes` array, expanded to specific runtime array via `determineRuntimes()` when value is `'all'`, passed to `installFiles()`/`uninstallFiles()` which handle multi-runtime fan-out internally.