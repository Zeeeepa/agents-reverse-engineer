---
generated_at: 2026-02-09T14:09:28.484Z
content_hash: 807d633ab0a3f34ba82995ad8707fd0c6baf723f73c6eedbd50258b6fbe3725c
purpose: `src/installer/index.ts` orchestrates npx installation workflows for ARE command files and session hooks across Claud...
---
**`src/installer/index.ts` orchestrates npx installation workflows for ARE command files and session hooks across Claude Code, OpenCode, and Gemini runtimes.**

## Exported Functions

`parseInstallerArgs(args: string[]): InstallerArgs` parses CLI flags (`--runtime`, `-g`/`--global`, `-l`/`--local`, `--force`, `-q`/`--quiet`, `-h`/`--help`) into `InstallerArgs`, validating `runtime` against `['claude', 'opencode', 'gemini', 'all']` and defaulting `uninstall: false`.

`runInstaller(args: InstallerArgs): Promise<InstallerResult[]>` executes install/uninstall workflows, handling help display via `showHelp()`, non-interactive mode validation (requires `--runtime` and location flags), interactive prompts via `selectRuntime()`/`selectLocation()`, and routing to `runInstall()` or `runUninstall()` based on `args.uninstall`.

`determineLocation(args: InstallerArgs): Location | undefined` returns `'global'` if `args.global && !args.local`, `'local'` if `args.local && !args.global`, or `undefined` for prompting.

`determineRuntimes(runtime: Runtime | undefined): Array<Exclude<Runtime, 'all'>>` expands `'all'` to `getAllRuntimes()` array or wraps single runtime.

`runInstall(runtime: Runtime, location: Location, force: boolean, quiet: boolean): Promise<InstallerResult[]>` calls `installFiles()` from `operations.ts`, verifies via `verifyInstallation()`, displays results via `displayInstallResults()`, and returns array of `InstallerResult`.

`runUninstall(runtime: Runtime, location: Location, quiet: boolean): InstallerResult[]` calls `uninstallFiles()` from `uninstall.ts`, deletes `.agents-reverse-engineer` folder via `deleteConfigFolder()` for local installs, displays via `displayUninstallResults()`.

`displayInstallResults(results: InstallerResult[]): void` aggregates `filesCreated.length`, `filesSkipped.length`, `hookRegistered` counts, calls `showSuccess()`/`showWarning()` for summary lines, invokes `showNextSteps()` with primary runtime, prints GitHub docs link.

`displayUninstallResults(results: InstallerResult[], configDeleted: boolean): void` counts deleted files (repurposed `filesCreated` field), hook unregistrations (repurposed `hookRegistered`), shows summary via `showSuccess()`/`showInfo()`.

## Re-Exports

Re-exports types `InstallerArgs`, `InstallerResult`, `Runtime`, `Location`, `RuntimePaths` from `types.ts`; functions `getRuntimePaths`, `getAllRuntimes`, `resolveInstallPath`, `getSettingsPath` from `paths.ts`; display utilities `displayBanner`, `showHelp`, `showSuccess`, `showError`, `showWarning`, `showInfo`, `showNextSteps`, `VERSION` from `banner.ts`; prompt utilities `selectRuntime`, `selectLocation`, `confirmAction`, `isInteractive` from `prompts.ts`.

## Integration with Installer Subsystem

Imports `installFiles`, `verifyInstallation` from `operations.ts` for copying command templates and hook files via `getTemplatesForRuntime()`, ensuring directories with `ensureDir()`, registering hooks in `settings.json` via `registerHooks()`/`registerPermissions()`, writing `ARE-VERSION` via `writeVersionFile()`.

Imports `uninstallFiles`, `deleteConfigFolder` from `uninstall.ts` for removing templates, hooks, cleaning empty directories recursively via `cleanupEmptyDirs()`, unregistering hooks via `unregisterHooks()`/`unregisterPermissions()`.

Coordinates dual-mode operation: interactive TTY uses arrow-key selection via `prompts.ts` raw mode handling (`arrowKeySelect()`), non-interactive CI mode uses numbered selection via `numberedSelect()`, enforcing flag requirements with `process.exit(1)` on missing values.

## Result Aggregation Pattern

`InstallerResult.filesCreated` tracks successfully written files during install, repurposed to track deleted files during uninstall. `InstallerResult.hookRegistered` indicates hook registration during install, repurposed to indicate hook unregistration during uninstall. `InstallerResult.filesSkipped` tracks existing files skipped without `--force` during install, non-existent files during uninstall. `InstallerResult.errors` accumulates error strings from failed file operations or JSON parsing failures in settings modification.