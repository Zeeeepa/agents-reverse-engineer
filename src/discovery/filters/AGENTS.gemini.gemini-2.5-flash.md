<!-- Generated by agents-reverse-engineer v1.0.1 -->

# src/discovery/filters
The `src/discovery/filters` directory encapsulates various file exclusion mechanisms, including filters for binary files, custom gitignore patterns, and vendor directories, all producing `FileFilter` instances to control which files are included in the discovery process.

## Contents
- `[binary.ts](./binary.ts)`: Implements `FileFilter` for binary file detection using extensions, content analysis, and size limitations.
- `[custom.ts](./custom.ts)`: Provides `createCustomFilter` to exclude files based on gitignore-style patterns using the `ignore` library.
- `[gitignore.ts](./gitignore.ts)`: Creates a `FileFilter` that excludes paths matching `.gitignore` patterns found in the `root` directory.
- `[vendor.ts](./vendor.ts)`: Filters out files residing within common vendor and dependency directories defined by `DEFAULT_VENDOR_DIRS`.

## API Surface
- `createBinaryFilter(options?: BinaryFilterOptions): FileFilter`: Creates a `FileFilter` instance for binary file exclusion.
- `createCustomFilter(patterns: string[], root: string): FileFilter`: Generates a `FileFilter` using provided gitignore-style `patterns` relative to `root`.
- `createGitignoreFilter(root: string): Promise<FileFilter>`: Asynchronously creates a `FileFilter` by parsing the `.gitignore` file within the specified `root` directory.
- `createVendorFilter(vendorDirs: string[]): FileFilter`: Generates a `FileFilter` to exclude files located within `vendorDirs`.

## Configuration
- `DEFAULT_MAX_FILE_SIZE`: From `binary.ts`, the `maxFileSize` for `BinaryFilterOptions` defaults to `1048576` bytes for binary detection.
- `DEFAULT_VENDOR_DIRS`: From `vendor.ts`, this `readonly string[]` defines common excluded directories: `'node_modules'`, `'vendor'`, `'.git'`, `'dist'`, `'build'`, ` '__pycache__'`, `'.next'`, `'venv'`, `'.venv'`, `'target'`.

## Behavioral Contracts
- From `gitignore.ts`: Trailing slashes are critically important for directory matching within the `ignore` library's pattern processing.
- From `binary.ts`: `BINARY_EXTENSIONS` (`Set<string>`) contains pre-defined binary file extensions, and `BinaryFilterOptions` (`interface`) includes `maxFileSize?: number` (default `1048576` bytes).

## File Relationships
All filter modules (`binary.ts`, `custom.ts`, `gitignore.ts`, `vendor.ts`) export functions that return instances of `FileFilter` (from `../types.js`), providing a unified interface for file exclusion logic. `createBinaryFilter` from `binary.ts` utilizes `isbinaryfile`'s `isBinaryFile` for content analysis and `node:fs/promises`'s `fs.stat` for size checks. `createCustomFilter` from `custom.ts` and `createGitignoreFilter` from `gitignore.ts` both leverage the `ignore` library for pattern matching, converting `absolutePath` to `relativePath` using `node:path`.

## Annex References
- `BINARY_EXTENSIONS` â€” Set of known binary file extensions (120+ lines)