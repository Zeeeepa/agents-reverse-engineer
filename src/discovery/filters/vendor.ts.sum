---
generated_at: 2026-02-09T14:07:57.891Z
content_hash: 8334930ab77a89aadf421359a55e0a69194517b120a26ca30f7e986838eabec0
purpose: createVendorFilter() implements a two-pattern directory exclusion filter for file discovery, matching both single dir...
---
**createVendorFilter() implements a two-pattern directory exclusion filter for file discovery, matching both single directory names (anywhere in path) and multi-segment path patterns (substring match).**

## Exported Functions

**createVendorFilter(vendorDirs: string[]): FileFilter** — Returns FileFilter with `name: 'vendor'` and `shouldExclude()` predicate that checks if `absolutePath` contains any single-segment directory name from `singleSegments` Set (split path into segments via `path.sep`, test each) or substring-matches any multi-segment pattern from `pathPatterns` array (normalized to OS-specific separators).

## Exported Constants

**DEFAULT_VENDOR_DIRS: readonly string[]** — Contains 10 third-party directory names: `'node_modules'`, `'vendor'`, `'.git'`, `'dist'`, `'build'`, `'__pycache__'`, `'.next'`, `'venv'`, `'.venv'`, `'target'`.

## Pattern Classification Algorithm

**Pattern separation logic:**
1. Normalize input `dir` via `.replace(/[\\/]/g, path.sep)` to convert both forward/backslashes to current OS separator
2. If normalized pattern contains `path.sep`, add to `pathPatterns` array (multi-segment patterns like `'apps/vendor'` or `'.agents/skills'`)
3. Otherwise add to `singleSegments` Set (single directory names like `'node_modules'`)

## shouldExclude() Matching Strategy

**Single-segment matching:**
- Splits `absolutePath` via `path.sep` into array of path components
- Iterates each segment, returns `true` if `singleSegments.has(segment)` succeeds

**Path-pattern matching:**
- Iterates `pathPatterns` array
- Returns `true` if `absolutePath.includes(pattern)` succeeds (substring search)
- Example: pattern `'.agents/skills'` matches `/project/apps/foo/.agents/skills/bar.md`

**Default return:** `false` if neither match succeeds

## Integration Points

**FileFilter interface** (from `../types.js`) — Requires `name: string` property and `shouldExclude(absolutePath: string): boolean` method. Used by filter chain in `src/discovery/walker.ts` composing gitignore, binary, vendor, and custom filters.

## Design Pattern

**Strategy pattern** — Implements FileFilter interface as pluggable exclusion rule. Discovery walker applies vendor filter alongside gitignore filter (from `ignore` library), binary filter (extension + content analysis), and custom glob patterns (from config YAML).