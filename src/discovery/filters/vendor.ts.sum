---
generated_at: 2026-02-09T15:05:53.329Z
content_hash: 8334930ab77a89aadf421359a55e0a69194517b120a26ca30f7e986838eabec0
purpose: createVendorFilter() implements directory exclusion filtering for third-party code paths via dual pattern matching (s...
---
**createVendorFilter() implements directory exclusion filtering for third-party code paths via dual pattern matching (single segment lookup, multi-segment substring search).**

## Exported Functions

### createVendorFilter(vendorDirs: string[]): FileFilter
Returns FileFilter implementing vendor directory exclusion via two-phase path analysis:
1. Splits vendorDirs into singleSegments (Set<string>) for directories like 'node_modules', 'vendor', '.git', 'dist', 'build', '__pycache__', '.next', 'venv', '.venv', 'target'
2. Normalizes multi-segment patterns (containing path.sep) into pathPatterns array for nested exclusions like 'apps/vendor' or '.agents/skills'

Returned FileFilter.shouldExclude() first checks if any path segment exists in singleSegments Set (O(1) lookup per segment), then performs substring search for each pathPattern via includes().

Pattern normalization replaces both forward/backslash with platform-specific path.sep via regex `/[\\/]/g`.

## Exported Constants

### DEFAULT_VENDOR_DIRS
Readonly tuple of 10 vendor directory names: 'node_modules', 'vendor', '.git', 'dist', 'build', '__pycache__', '.next', 'venv', '.venv', 'target'. Used as default exclusion list in config schema (src/config/defaults.ts references this constant).

## Type Dependencies

### FileFilter
Interface from '../types.js' requiring:
- name: string property (set to 'vendor' in returned object)
- shouldExclude(absolutePath: string): boolean method

## Path Matching Strategy

Single segments match any occurrence in path (e.g., singleSegments.has('node_modules') matches '/project/node_modules/pkg/index.js' and '/apps/client/node_modules/lib.js').

Multi-segment patterns require ordered substring match (e.g., '.agents/skills' matches '/project/apps/foo/.agents/skills/bar.md' but not '/project/.agents/data/skills.md' or '/project/skills/.agents/foo.md').

Normalization handles cross-platform paths before pattern split decision via path.sep boundary detection.