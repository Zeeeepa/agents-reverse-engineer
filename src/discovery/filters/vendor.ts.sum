---
generated_at: 2026-02-09T21:27:47.889Z
content_hash: 8334930ab77a89aadf421359a55e0a69194517b120a26ca30f7e986838eabec0
purpose: createVendorFilter() excludes files within third-party dependency directories via single-segment matching and path-pa...
---
**createVendorFilter() excludes files within third-party dependency directories via single-segment matching and path-pattern substring containment, supporting both flat directory names (e.g., `node_modules`) and hierarchical patterns (e.g., `.agents/skills`).**

## Exported Symbols

**DEFAULT_VENDOR_DIRS**: `readonly string[]` — Array of 10 default vendor directory names to exclude: `node_modules`, `vendor`, `.git`, `dist`, `build`, `__pycache__`, `.next`, `venv`, `.venv`, `target`.

**createVendorFilter(vendorDirs: string[]): FileFilter** — Constructs a `FileFilter` instance with `shouldExclude()` method implementing dual-pattern matching logic.

## Matching Algorithms

**createVendorFilter()** partitions input `vendorDirs` into two collections:

1. **Single segments** (no path separators): Stored in `Set<string>` for O(1) lookup. Path split via `path.sep` yields segment array; filter returns `true` if any segment exists in set.
2. **Path patterns** (containing `path.sep`): Stored in `string[]`. Filter returns `true` if `absolutePath.includes(pattern)` for any pattern.

Path normalization via `dir.replace(/[\\/]/g, path.sep)` ensures cross-platform separator handling before classification.

## Filter Interface

Returned `FileFilter` object contains:
- **name**: `'vendor'` — Filter identifier for debugging/logging.
- **shouldExclude(absolutePath: string): boolean** — Returns `true` if path matches either single-segment or path-pattern rules.

## Integration Points

Imports `FileFilter` from `../types.js`. Consumed by filter chain in `src/discovery/filters/index.ts` alongside `createBinaryFilter()`, `createGitignoreFilter()`, `createCustomFilter()`. Applied during `walk()` in `src/discovery/walker.ts` to exclude vendor directories from file discovery results.

## Pattern Examples

Single-segment match: `/project/node_modules/lodash/index.js` → splits to `['', 'project', 'node_modules', 'lodash', 'index.js']` → `'node_modules'` in `singleSegments` → returns `true`.

Path-pattern match: `/project/apps/foo/.agents/skills/bar.md` → `includes('.agents/skills')` → returns `true` (assuming `.agents/skills` in `pathPatterns` after normalization).

No match: `/project/src/utils.js` → no segment in `singleSegments`, no pattern in `pathPatterns` → returns `false`.