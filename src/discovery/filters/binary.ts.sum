---
generated_at: 2026-02-09T14:07:59.311Z
content_hash: 0413cc0407abd16929f8e47ccef5f2f7a1ba233c05fce4b56e6da03dabba5981
purpose: createBinaryFilter() implements two-phase binary file detection (extension-based fast path, content analysis fallback...
---
**createBinaryFilter() implements two-phase binary file detection (extension-based fast path, content analysis fallback) with configurable size limits for file discovery filtering.**

## Exported Functions

**createBinaryFilter(options?: BinaryFilterOptions): FileFilter** — Factory function that constructs a FileFilter instance rejecting binary files and oversized files. Fast path checks file extension against BINARY_EXTENSIONS set (91 entries), slow path invokes `isBinaryFile(absolutePath)` from `isbinaryfile` library for unknown extensions. Returns object with `name: 'binary'` and async `shouldExclude(absolutePath: string): Promise<boolean>` method. File size check via `fs.stat(absolutePath).size > maxFileSize` precedes content analysis. Defaults to `maxFileSize = 1048576` (1MB). Supports `additionalExtensions` array for custom binary types (normalized to include leading dot).

## Exported Constants

**BINARY_EXTENSIONS: Set<string>** — Hardcoded set of 91 file extensions known to be binary, organized into categories: images (.png, .jpg, .jpeg, .gif, .bmp, .ico, .webp, .svg, .tiff, .tif, .psd, .raw, .heif, .heic), archives (.zip, .tar, .gz, .rar, .7z, .bz2, .xz, .tgz), executables (.exe, .dll, .so, .dylib, .bin, .msi, .app, .dmg), media (.mp3, .mp4, .wav, .avi, .mov, .mkv, .flac, .ogg, .webm, .m4a, .aac, .wma, .wmv, .flv), binary documents (.pdf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .odt, .ods, .odp), fonts (.woff, .woff2, .ttf, .eot, .otf), compiled bytecode (.class, .pyc, .pyo, .o, .obj, .a, .lib, .wasm), databases (.db, .sqlite, .sqlite3, .mdb), and miscellaneous (.ico, .icns, .cur, .deb, .rpm, .jar, .war, .ear). Used as authoritative reference for extension-based exclusion without content inspection.

## Types

**BinaryFilterOptions** — Configuration interface with optional `maxFileSize?: number` (file size threshold in bytes, default 1048576) and `additionalExtensions?: string[]` (custom binary extensions merged into BINARY_EXTENSIONS).

## Integration Points

Implements `FileFilter` interface from `../types.js` requiring `name: string` and `shouldExclude(absolutePath: string): Promise<boolean>`. Consumed by filter composition pipeline in `src/discovery/filters/index.ts`. Depends on `isbinaryfile` library for content-based binary detection and Node.js `fs.promises.stat()` for file metadata. Extension normalization via `path.extname(absolutePath).toLowerCase()` ensures case-insensitive matching.

## Error Handling

Catch block in `shouldExclude()` returns `true` (exclude) for any `fs.stat()` or `isBinaryFile()` errors, treating unreadable files as binary. No error differentiation between ENOENT, EACCES, or content analysis failures.

## Performance Strategy

Two-phase detection minimizes I/O overhead: extension lookup via `Set.has()` O(1) operation bypasses file system access for 91 known types. Content analysis via `isBinaryFile()` only invoked for unknown extensions after size check passes. Size check (`stats.size > maxFileSize`) gates expensive binary content heuristics.