---
generated_at: 2026-02-09T17:43:55.662Z
content_hash: fb529e7928634e7d905de0768cd5e34fecc4318031610a43f56fc4f0e3fb38e9
purpose: createCustomFilter() constructs a FileFilter that excludes files matching user-provided gitignore-style patterns via ...
---
**createCustomFilter() constructs a FileFilter that excludes files matching user-provided gitignore-style patterns via the `ignore` library with relative path normalization.**

## Exported Interface

`createCustomFilter(patterns: string[], root: string): FileFilter` â€” Returns a FileFilter named `'custom'` that checks absolute paths against gitignore-style exclusion patterns. Empty pattern array results in pass-through filter (excludes nothing).

## Pattern Matching Strategy

Uses `ignore` library instance (`Ignore` type) initialized via `ignore()` factory. Patterns added via `ig.add(patterns)` bulk operation. Matching performed via `ig.ignores(relativePath)` against paths converted from absolute to relative using `path.relative(normalizedRoot, absolutePath)`.

## Path Normalization

`normalizedRoot` computed via `path.resolve(root)` to canonicalize user-provided root. `shouldExclude()` converts absolute paths to relative before matching. Paths outside root (starting with `..`) or empty relative paths return `false` (not excluded) as guard against incorrect pattern application.

## Integration Point

Returns `FileFilter` interface from `../types.js` with `name: 'custom'` discriminator and `shouldExclude(absolutePath: string): boolean` predicate. Composable with other filters in `src/discovery/filters/index.ts` filter chain.

## Short-Circuit Behavior

`shouldExclude()` returns `false` early when `patterns.length === 0` (no patterns configured). Second early return when relative path is empty or starts with `'..'` prevents matching against files outside project root.