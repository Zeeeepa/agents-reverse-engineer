---
generated_at: 2026-02-09T17:43:56.544Z
content_hash: 21bf8f8555dac27a2608934b9016f732256e87fab42ec4dce4f6c8f1b746e901
purpose: createGitignoreFilter() returns a FileFilter that excludes files matching .gitignore patterns using the ignore librar...
---
**createGitignoreFilter() returns a FileFilter that excludes files matching .gitignore patterns using the ignore library with relative path normalization.**

## Exported Function

**createGitignoreFilter(root: string): Promise<FileFilter>**
- Resolves root directory via path.resolve()
- Attempts to read .gitignore from `path.join(normalizedRoot, '.gitignore')` using fs.readFile() with utf-8 encoding
- Creates Ignore instance via ignore() library
- Adds .gitignore content to Ignore instance via ig.add(content)
- Silently continues on read failure (missing .gitignore passes all paths)
- Returns FileFilter object with name property `'gitignore'` and shouldExclude() method

## FileFilter Implementation

**shouldExclude(absolutePath: string): boolean**
- Converts absolutePath to relativePath via path.relative(normalizedRoot, absolutePath)
- Returns false if relativePath is empty or starts with `'..'` (paths outside root)
- Delegates to ig.ignores(relativePath) for pattern matching
- Passes relative paths without trailing slash (file-only mode, not directory mode)

## Dependencies

- `ignore` library (Ignore type) for .gitignore pattern parsing and matching
- `node:fs/promises` for async file reading (fs.readFile)
- `node:path` for path normalization (path.resolve, path.join, path.relative)
- `../types.js` for FileFilter interface

## Critical Behavior

The ignore library treats paths differently based on trailing slashes. This implementation passes relativePath without appending slash because walker returns files only, not directories. Directory exclusion would require `relativePath + '/'` pattern.