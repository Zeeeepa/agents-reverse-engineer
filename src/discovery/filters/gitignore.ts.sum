---
generated_at: 2026-02-09T15:05:50.953Z
content_hash: 21bf8f8555dac27a2608934b9016f732256e87fab42ec4dce4f6c8f1b746e901
purpose: createGitignoreFilter produces a FileFilter that excludes paths matching .gitignore patterns by parsing the root .git...
---
**createGitignoreFilter produces a FileFilter that excludes paths matching .gitignore patterns by parsing the root .gitignore file via the ignore library.**

## Exported Interface

- `createGitignoreFilter(root: string): Promise<FileFilter>` â€” Async factory function that resolves the root directory path, reads `.gitignore` if present, populates an `Ignore` instance from the ignore library, and returns a FileFilter object with `name: 'gitignore'` and a `shouldExclude(absolutePath: string): boolean` method.

## Implementation Details

The `shouldExclude` method converts absolute paths to relative paths via `path.relative(normalizedRoot, absolutePath)`, returns `false` for paths outside the root (starting with `..`) or empty paths, and delegates to `ig.ignores(relativePath)` for pattern matching. The ignore library requires relative paths and treats directory paths differently based on trailing slashes; this implementation omits trailing slashes since the discovery walker returns files only, not directories.

## Error Handling

If `.gitignore` does not exist at `path.join(normalizedRoot, '.gitignore')`, the `fs.readFile()` failure is silently caught in an empty catch block, leaving the `Ignore` instance unpopulated so `ig.ignores()` returns `false` for all paths (no exclusions applied).

## Dependencies

- `ignore` library (type `Ignore`) for .gitignore pattern parsing and matching
- `node:fs/promises` for async `.gitignore` file reading via `fs.readFile()`
- `node:path` for path resolution (`path.resolve()`, `path.relative()`, `path.join()`)
- `../types.js` exports `FileFilter` interface with `name: string` and `shouldExclude(absolutePath: string): boolean`

## Integration Context

This filter is one of the composable filters in `src/discovery/filters/` alongside binary.ts, custom.ts, and vendor.ts. The discovery walker in `src/discovery/walker.ts` chains these filters to determine file exclusion during the file discovery phase (Phase 1 of the three-phase generation pipeline).