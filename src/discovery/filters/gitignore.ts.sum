---
generated_at: 2026-02-09T14:07:53.063Z
content_hash: 21bf8f8555dac27a2608934b9016f732256e87fab42ec4dce4f6c8f1b746e901
purpose: createGitignoreFilter creates a FileFilter that excludes files matching .gitignore patterns by loading and parsing th...
---
**createGitignoreFilter creates a FileFilter that excludes files matching .gitignore patterns by loading and parsing the root .gitignore file via the ignore library.**

## Exported Function

**createGitignoreFilter(root: string): Promise<FileFilter>**
- Returns FileFilter with name `'gitignore'` and shouldExclude predicate
- Loads .gitignore from `path.join(root, '.gitignore')` if it exists
- Silently passes all files if .gitignore is missing or unreadable
- Normalizes root via `path.resolve()` for absolute path resolution

## Integration Points

- Implements FileFilter interface from `../types.js` (requires `name: string` and `shouldExclude(absolutePath: string): boolean`)
- Used by filter chain in `src/discovery/walker.ts` alongside binary/vendor/custom filters
- Consumed by `createGitignoreFilter` aggregator in `src/discovery/filters/index.ts`

## Path Processing Logic

**shouldExclude(absolutePath: string)**
- Converts absolute paths to relative via `path.relative(normalizedRoot, absolutePath)` (ignore library requires relative paths)
- Returns false for paths outside root (relativePath starts with `'..'`) or empty relativePath
- Calls `ig.ignores(relativePath)` without trailing slash (walker provides file paths only, not directories)
- Critical constraint: ignore library treats paths differently with/without trailing slashâ€”directory exclusion would need slash appending

## Dependencies

- **ignore**: Ignore instance created via `ignore()`, patterns added via `ig.add(content)`, matching via `ig.ignores(relativePath)`
- **fs.promises**: Reads .gitignore content via `fs.readFile(gitignorePath, 'utf-8')`
- **path**: Resolves root, joins gitignorePath, computes relative paths

## Error Handling

- Try-catch around `fs.readFile()` swallows all errors (missing file, permission denied, invalid encoding)
- Empty Ignore instance passes all paths when no .gitignore exists