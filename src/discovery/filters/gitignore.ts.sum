---
generated_at: 2026-02-09T21:27:53.027Z
content_hash: 21bf8f8555dac27a2608934b9016f732256e87fab42ec4dce4f6c8f1b746e901
purpose: createGitignoreFilter() builds a FileFilter that excludes paths matching .gitignore patterns using the `ignore` library.
---
**createGitignoreFilter() builds a FileFilter that excludes paths matching .gitignore patterns using the `ignore` library.**

## Exported Interface

```typescript
async function createGitignoreFilter(root: string): Promise<FileFilter>
```

Returns a `FileFilter` object with `name: 'gitignore'` and `shouldExclude(absolutePath: string): boolean` method.

## Implementation Details

createGitignoreFilter() normalizes `root` via `path.resolve()`, attempts to read `.gitignore` from `path.join(normalizedRoot, '.gitignore')`, passes content to `ignore.add()` if file exists, silently skips if ENOENT occurs (try-catch with empty catch block).

shouldExclude() converts `absolutePath` to relative via `path.relative(normalizedRoot, absolutePath)`, returns `false` immediately if relativePath is empty or starts with `'..'` (path outside root), calls `ig.ignores(relativePath)` otherwise.

## Critical Constraints

The `ignore` library requires relative paths without leading slashes. shouldExclude() does NOT append trailing slash to paths, assuming walker returns files only (not directories). Directory exclusion would require appending `/` to directory paths before calling `ig.ignores()`.

Returns `false` for paths outside root tree to prevent exclusion of unrelated filesystem locations.

## Dependencies

- `ignore` library (`import ignore, { type Ignore } from 'ignore'`) for .gitignore pattern matching
- `fs.promises.readFile()` for async .gitignore content loading
- `path.resolve()`, `path.join()`, `path.relative()` for path normalization

## Integration

Used in composable filter chain via `src/discovery/filters/index.ts` alongside binary, vendor, and custom pattern filters. Returned `FileFilter` object matches `FileFilter` interface from `src/discovery/types.ts`.