<!-- Generated by agents-reverse-engineer v0.9.10 -->

# src/config

Configuration management for agents-reverse-engineer: loading, validating, and providing default values for the tool's runtime behavior, file exclusion patterns, binary detection, AI service settings, and concurrency limits.

## Contents

### Defaults
[defaults.ts](./defaults.ts) exports `getDefaultConcurrency()` (cores × CONCURRENCY_MULTIPLIER clamped to MIN_CONCURRENCY=2, MAX_CONCURRENCY=20, with memory cap from totalMemGB × 0.5 ÷ 0.512 GB/subprocess), `DEFAULT_VENDOR_DIRS`, `DEFAULT_EXCLUDE_PATTERNS` (gitignore syntax), `DEFAULT_BINARY_EXTENSIONS`, size/compression limits, and a merged `DEFAULT_CONFIG` object.

### Schema & Validation
[schema.ts](./schema.ts) defines Zod validation schemas: `ConfigSchema` (root), `ExcludeSchema`, `OptionsSchema`, `OutputSchema`, `GenerationSchema` (compressionRatio 0.1–1.0), and `AISchema` (backend enum, model, timeoutMs=300s, maxRetries=3, concurrency 1–20, telemetry.keepRuns=50); exports `Config` type inferred from ConfigSchema.

### Runtime Loading
[loader.ts](./loader.ts) provides `loadConfig(root, options?)` to parse `.agents-reverse-engineer/config.yaml` via ConfigSchema with fallback to defaults, `findProjectRoot(startDir)` to locate `.agents-reverse-engineer/`, `configExists(root)`, and `writeDefaultConfig(root)` to scaffold config.yaml; throws `ConfigError` (extends Error with filePath and cause) on parse/validation failure.

## Configuration Contracts

- **compressionRatio**: 0.1–1.0; controls .sum file verbosity (0.1 = aggressive, 0.5 = verbose).
- **backend**: enum `['claude', 'codex', 'gemini', 'opencode', 'auto']`; 'auto' detects from PATH.
- **concurrency**: 1–20; auto-detected via `getDefaultConcurrency()` if omitted.
- **timeoutMs**: default 300,000 (5 min for subprocess execution).
- **maxRetries**: default 3 for transient errors.
- **telemetry.keepRuns**: default 50 retained run logs.

## Constants & Thresholds

- CONCURRENCY_MULTIPLIER = 5; MIN_CONCURRENCY = 2; MAX_CONCURRENCY = 20.
- SUBPROCESS_HEAP_GB = 0.512; MEMORY_FRACTION = 0.5.
- DEFAULT_MAX_FILE_SIZE = 1048576 (1 MB); DEFAULT_COMPRESSION_RATIO = 0.25.
- CONFIG_DIR = `.agents-reverse-engineer`; CONFIG_FILE = `config.yaml`.

## Integration Points

- Consumed by `src/cli/` commands (init, generate, update, discover, rebuild, specify).
- Provides defaults to `src/discovery/` (file filters via exclude patterns/binary extensions/vendor dirs).
- Supplies AI backend config to `src/ai/` (backend enum, concurrency, timeoutMs, maxRetries).
- Trace events (`config:loaded`) emitted to `src/orchestration/trace.js` via ITraceWriter.