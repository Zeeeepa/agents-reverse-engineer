---
generated_at: 2026-02-09T17:44:53.427Z
content_hash: ddcb35a58fc7c96be861daff467611b0b3f9fa7cb760da90af97960452c887c8
purpose: ConfigSchema defines Zod validation schema for `.agents-reverse-engineer/config.yaml` with nested object structures f...
---
**ConfigSchema defines Zod validation schema for `.agents-reverse-engineer/config.yaml` with nested object structures for exclusion rules, discovery options, output formatting, and AI service configuration, enforcing type safety and providing default values for all fields.**

## Schema Structure

ConfigSchema is the root schema composed of four nested schemas: ExcludeSchema, OptionsSchema, OutputSchema, and AISchema. Each sub-schema has `.default({})` fallback enabling empty object validation.

## Exported Schemas

**ExcludeSchema** validates exclusion configuration with three array fields:
- `patterns: z.array(z.string()).default([...DEFAULT_EXCLUDE_PATTERNS])` — custom glob patterns for file exclusion
- `vendorDirs: z.array(z.string()).default([...DEFAULT_VENDOR_DIRS])` — vendor directory names to skip
- `binaryExtensions: z.array(z.string()).default([...DEFAULT_BINARY_EXTENSIONS])` — binary file extension list

**OptionsSchema** validates discovery behavior with two fields:
- `followSymlinks: z.boolean().default(false)` — symbolic link traversal toggle
- `maxFileSize: z.number().positive().default(DEFAULT_MAX_FILE_SIZE)` — file size threshold in bytes for skipping large files

**OutputSchema** validates terminal output formatting:
- `colors: z.boolean().default(true)` — ANSI color code toggle for CLI output

**AISchema** validates AI service configuration with six fields:
- `backend: z.enum(['claude', 'gemini', 'opencode', 'auto']).default('auto')` — AI CLI backend selection with auto-detection
- `model: z.string().default('sonnet')` — backend-specific model identifier
- `timeoutMs: z.number().positive().default(300_000)` — subprocess timeout (5 minutes default)
- `maxRetries: z.number().min(0).default(3)` — exponential backoff retry limit
- `concurrency: z.number().min(1).max(20).default(getDefaultConcurrency)` — worker pool size (1-20 range, auto-detected default)
- `telemetry: z.object({ keepRuns: z.number().min(0).default(50) }).default({})` — nested schema for run log retention count

**ConfigSchema** combines all sub-schemas:
```typescript
z.object({
  exclude: ExcludeSchema,
  options: OptionsSchema,
  output: OutputSchema,
  ai: AISchema,
}).default({})
```

## Exported Types

**Config** = `z.infer<typeof ConfigSchema>` — inferred TypeScript type for full configuration object

**ExcludeConfig** = `z.infer<typeof ExcludeSchema>` — inferred type for `exclude` section

**OptionsConfig** = `z.infer<typeof OptionsSchema>` — inferred type for `options` section

**OutputConfig** = `z.infer<typeof OutputSchema>` — inferred type for `output` section

**AIConfig** = `z.infer<typeof AISchema>` — inferred type for `ai` section

## Dependencies

Imports DEFAULT_VENDOR_DIRS, DEFAULT_BINARY_EXTENSIONS, DEFAULT_MAX_FILE_SIZE, DEFAULT_EXCLUDE_PATTERNS, and getDefaultConcurrency from `./defaults.js` for default value arrays and computation.

## Validation Behavior

All schemas use `.default()` chaining enabling partial configuration parsing: `ConfigSchema.parse({})` returns fully populated Config object with all defaults applied. Spread operator `[...DEFAULT_VENDOR_DIRS]` creates shallow copies preventing array mutation across parse invocations.