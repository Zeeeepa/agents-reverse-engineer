---
generated_at: 2026-02-09T13:18:25.932Z
content_hash: 42fa51670b055eae335470b88121535bbd72454dc75676dce8f7b0224c943bc7
purpose: Defines Zod validation schemas and TypeScript types for the `.agents-reverse-engineer/config.yaml` configuration file...
---
**Defines Zod validation schemas and TypeScript types for the `.agents-reverse-engineer/config.yaml` configuration file, with nested schemas for exclude rules, discovery options, output formatting, and AI service settings.**

## Exported Schemas

`ExcludeSchema` validates exclusion configuration with three array fields: `patterns` (custom glob patterns, defaults to `DEFAULT_EXCLUDE_PATTERNS`), `vendorDirs` (defaults to `DEFAULT_VENDOR_DIRS`), and `binaryExtensions` (defaults to `DEFAULT_BINARY_EXTENSIONS`). All fields use array spread to copy defaults.

`OptionsSchema` validates discovery options with two fields: `followSymlinks` (boolean, defaults to `false`) and `maxFileSize` (positive number in bytes, defaults to `DEFAULT_MAX_FILE_SIZE`).

`OutputSchema` validates output configuration with a single `colors` boolean field defaulting to `true` for terminal color support.

`AISchema` validates AI service configuration with six fields: `backend` (enum of `'claude' | 'gemini' | 'opencode' | 'auto'`, defaults to `'auto'`), `model` (string, defaults to `'sonnet'`), `timeoutMs` (positive number, defaults to `300_000`), `maxRetries` (non-negative number, defaults to `3`), `concurrency` (number between 1-20, defaults to `5`), and nested `telemetry` object containing `keepRuns` (non-negative number, defaults to `50`).

`ConfigSchema` composes all sub-schemas into a main configuration schema with four top-level fields: `exclude` (ExcludeSchema), `options` (OptionsSchema), `output` (OutputSchema), and `ai` (AISchema). All fields have `.default({})` making empty objects valid and resulting in fully populated configurations.

## Exported Types

`Config` is the inferred TypeScript type from `ConfigSchema` via `z.infer`, used for function parameters and return types throughout the codebase.

`ExcludeConfig` infers from `ExcludeSchema`, `OptionsConfig` from `OptionsSchema`, `OutputConfig` from `OutputSchema`, and `AIConfig` from `AISchema`. These granular types enable type-safe access to configuration subsections.

## Dependencies

Imports `z` from `zod` for schema validation. Imports `DEFAULT_VENDOR_DIRS`, `DEFAULT_BINARY_EXTENSIONS`, `DEFAULT_MAX_FILE_SIZE`, and `DEFAULT_EXCLUDE_PATTERNS` from `./defaults.js` to populate default values across schemas.

## Design Pattern

Implements defensive copying via array spread operators (`[...DEFAULT_EXCLUDE_PATTERNS]`) to prevent shared reference mutation when defaults are used. All schemas cascade `.default({})` to enable incremental configuration overrides where partial objects are merged with defaults during parsing.