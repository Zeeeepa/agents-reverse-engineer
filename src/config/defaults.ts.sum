---
generated_at: 2026-02-09T13:42:34.136Z
content_hash: d0147438ee839084207379c5515a452f672f61498191379daa10e01067d4c333
purpose: defaults.ts exports configuration constants and getDefaultConcurrency() for computing runtime concurrency limits base...
---
**defaults.ts exports configuration constants and getDefaultConcurrency() for computing runtime concurrency limits based on CPU cores and available system memory.**

## Exported Constants

- `DEFAULT_VENDOR_DIRS`: Array of 18 directory names excluded from analysis (node_modules, vendor, .git, dist, build, __pycache__, .next, venv, .venv, target, .cargo, .gradle, .agents-reverse-engineer, .agents, .planning, .claude, .opencode, .gemini)
- `DEFAULT_EXCLUDE_PATTERNS`: Array of 30 gitignore-style glob patterns skipping AI documentation files (AGENTS.md, CLAUDE.md, OPENCODE.md, GEMINI.md with recursive variants), lock files (*.lock, package-lock.json, yarn.lock, pnpm-lock.yaml, bun.lock, bun.lockb, Gemfile.lock, Cargo.lock, poetry.lock, composer.lock, go.sum), dotfiles (.gitignore, .gitattributes, .gitkeep, .env, **/.env, **/.env.*), and generated artifacts (*.log, *.sum, **/*.sum, **/SKILL.md)
- `DEFAULT_BINARY_EXTENSIONS`: Array of 26 file extensions for binary files (images: .png, .jpg, .jpeg, .gif, .bmp, .ico, .webp; archives: .zip, .tar, .gz, .rar, .7z; executables: .exe, .dll, .so, .dylib; media: .mp3, .mp4, .wav; documents: .pdf; fonts: .woff, .woff2, .ttf, .eot; compiled: .class, .pyc)
- `DEFAULT_MAX_FILE_SIZE`: Number constant 1048576 (1MB threshold for binary detection)
- `DEFAULT_CONFIG`: Object literal combining exclude patterns, vendor directories, binary extensions, followSymlinks: false, maxFileSize: DEFAULT_MAX_FILE_SIZE, colors: true

## Concurrency Calculation

`getDefaultConcurrency()` returns integer clamped between `MIN_CONCURRENCY` (2) and `MAX_CONCURRENCY` (20) using formula: `clamp(cores * CONCURRENCY_MULTIPLIER, MIN, min(memCap, MAX))`. Computes `cores` via `os.availableParallelism()` or fallback `os.cpus().length`, calculates `memCap` as `floor((totalMemGB * MEMORY_FRACTION) / SUBPROCESS_HEAP_GB)` where `MEMORY_FRACTION = 0.5` and `SUBPROCESS_HEAP_GB = 0.512`. Memory cap enforces 50% RAM allocation to subprocesses with 512MB heap per subprocess (matches NODE_OPTIONS --max-old-space-size=512 from subprocess.ts resource management).

## Module Constants

- `CONCURRENCY_MULTIPLIER = 5`: Multiplier applied to CPU core count for initial concurrency estimate
- `MIN_CONCURRENCY = 2`: Lower bound for concurrency (matches WSL resource-constrained default)
- `MAX_CONCURRENCY = 20`: Upper bound matching Zod schema .max(20) constraint
- `SUBPROCESS_HEAP_GB = 0.512`: Per-subprocess memory budget in gigabytes
- `MEMORY_FRACTION = 0.5`: Fraction of system RAM allocated to subprocess pool