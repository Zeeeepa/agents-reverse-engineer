---
generated_at: 2026-02-09T15:07:02.946Z
content_hash: 4a69c6ca8327582e8a6dc390f7ea2e7d38e67c9e93128163405cea5db79d3252
purpose: complexity.ts computes codebase structure metrics from file path lists: file count, maximum directory depth via path ...
---
**complexity.ts computes codebase structure metrics from file path lists: file count, maximum directory depth via path separator splitting, and unique directory set via parent traversal.**

## Exported Interface

`ComplexityMetrics` contains:
- `fileCount: number` — Total source file count
- `directoryDepth: number` — Maximum nesting level from project root
- `files: string[]` — Source file path array
- `directories: Set<string>` — Unique directory paths extracted via parent traversal

## Exported Function

`analyzeComplexity(files: string[], projectRoot: string): ComplexityMetrics` orchestrates metric computation by invoking `calculateDirectoryDepth()` and `extractDirectories()`, returning populated `ComplexityMetrics` object with `fileCount` derived from `files.length`.

## Internal Algorithms

`calculateDirectoryDepth()` computes maximum depth by splitting `path.relative(projectRoot, file)` on `path.sep`, subtracting 1 (file itself doesn't count as directory level), tracking `Math.max()` across all files.

`extractDirectories()` walks parent chain for each file via `path.dirname()` loop, adding to `Set<string>` until reaching root (detected when `parent === dir`), stops at `'.'` sentinel to prevent infinite loops.

## Integration Points

Used by `src/generation/orchestrator.ts` to compute codebase scale metrics during discover/generate phases. Metrics inform concurrency tuning decisions and progress reporting via `src/orchestration/progress.ts`.

## Design Pattern

Pure functional composition: `analyzeComplexity()` delegates to stateless helper functions operating on path string arrays. `Set<string>` ensures directory uniqueness without manual deduplication logic.