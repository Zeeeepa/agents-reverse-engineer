---
generated_at: 2026-02-09T15:51:01.113Z
content_hash: 6c9b1af94741c383797e983a214b9053f46ebbd3312eb0cd56ec42aec4624ccb
purpose: types.ts defines TypeScript interfaces and constants for prompt construction in the three-phase documentation generat...
---
**types.ts defines TypeScript interfaces and constants for prompt construction in the three-phase documentation generation pipeline.**

## Exported Types

**PromptContext** interface structures the data bundle passed to prompt builders across all three generation phases:
- `filePath: string` — absolute path to target file for Phase 1 analysis or directory for Phase 2 aggregation
- `content: string` — file content (Phase 1) or aggregated child `.sum` content (Phase 2)
- `contextFiles?: Array<{ path: string; content: string }>` — optional sibling files for import relationship context
- `projectPlan?: string` — optional GENERATION-PLAN.md content providing bird's-eye view of codebase structure
- `existingSum?: string` — previous `.sum` content for incremental updates (enables diff-based regeneration)

## Summary Guidelines

**SUMMARY_GUIDELINES** constant exports frozen object with validation constraints for `.sum` file quality:

```typescript
{
  targetLength: { min: 300, max: 500 },
  include: [
    'Purpose and responsibility',
    'Public interface (exports, key functions)',
    'Key patterns and notable algorithms',
    'Dependencies with usage context',
    'Key function signatures as code snippets',
    'Tightly coupled sibling files',
    'Behavioral contracts: verbatim regex patterns, format strings, magic constants, sentinel values, output templates, environment variables',
  ],
  exclude: [
    'Control flow minutiae (loop structures, variable naming, temporary state)',
    'Generic TODOs/FIXMEs (keep only security/breaking)',
    'Broad architectural relationships (handled by AGENTS.md)',
  ],
}
```

**`targetLength`** defines word count range (300-500) enforced by density validators in `src/quality/density/validator.ts`.

**`include`** array specifies required content elements:
- `'Purpose and responsibility'` — one-line purpose statement
- `'Public interface (exports, key functions)'` — exported symbols extracted by code-vs-doc validator (`src/quality/inconsistency/code-vs-doc.ts`)
- `'Key patterns and notable algorithms'` — design pattern identification (Strategy, Builder, etc.)
- `'Dependencies with usage context'` — import statements with usage rationale
- `'Key function signatures as code snippets'` — TypeScript/JavaScript signatures with parameter types
- `'Tightly coupled sibling files'` — related files detected via `extractDirectoryImports()` in `src/imports/extractor.ts`
- `'Behavioral contracts: verbatim regex patterns, format strings, magic constants, sentinel values, output templates, environment variables'` — concrete values required for correct integration (e.g., `NODE_OPTIONS='--max-old-space-size=512'`, `/^[ \t]*export\s+/gm`, `<!-- Generated by agents-reverse-engineer -->`)

**`exclude`** array defines content to omit:
- `'Control flow minutiae (loop structures, variable naming, temporary state)'` — private implementation details
- `'Generic TODOs/FIXMEs (keep only security/breaking)'` — filters low-priority comments
- `'Broad architectural relationships (handled by AGENTS.md)'` — defers system-level patterns to Phase 2 directory aggregation

## Integration Points

Consumed by `buildFileAnalysisPrompt()` and `buildDirectoryPrompt()` in `src/generation/prompts/builder.ts` to construct AI subprocess prompts. The `PromptContext` interface threads through `executePhase1()`, `executePhase2()`, `executePhase3()` in `src/generation/executor.ts` as input to `AIService.call()`.

Guidelines enforced during quality validation via `validateCodeDocConsistency()` and `validateCodeCodeConsistency()` in `src/quality/inconsistency/` modules, checking that all `include` items appear in generated summaries and no `exclude` items dominate the content.