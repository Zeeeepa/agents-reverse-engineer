---
generated_at: 2026-02-09T21:29:55.919Z
content_hash: 6ac4e72fce4d5bde875f091b195d159ef667222d8c871b9f30b1d4b4eb838126
purpose: types.ts defines TypeScript interfaces for orchestration module communication: task results, run summaries, progress ...
---
**types.ts defines TypeScript interfaces for orchestration module communication: task results, run summaries, progress events, and command options that flow between worker pools, progress reporters, and command runners.**

## Exported Interfaces

**FileTaskResult** represents the outcome of processing a single file through AI analysis:
- `path: string` — relative path to source file
- `success: boolean` — whether AI call succeeded
- `tokensIn: number` — input tokens consumed (non-cached)
- `tokensOut: number` — output tokens generated
- `cacheReadTokens: number` — cache read input tokens
- `cacheCreationTokens: number` — cache creation input tokens
- `durationMs: number` — wall-clock duration in milliseconds
- `model: string` — model identifier used for this call
- `error?: string` — error message if call failed

**RunSummary** aggregates command execution metrics for telemetry and display:
- `version: string` — agents-reverse-engineer version
- `filesProcessed: number` — successfully processed file count
- `filesFailed: number` — failed file count
- `filesSkipped: number` — skipped file count (e.g., dry-run)
- `totalCalls: number` — AI call count
- `totalInputTokens: number` — sum of input tokens across calls
- `totalOutputTokens: number` — sum of output tokens across calls
- `totalCacheReadTokens: number` — sum of cache read tokens
- `totalCacheCreationTokens: number` — sum of cache creation tokens
- `totalDurationMs: number` — total wall-clock duration
- `errorCount: number` — error count
- `retryCount: number` — retry count
- `totalFilesRead: number` — total file reads across calls
- `uniqueFilesRead: number` — unique files read (deduped by path)
- `inconsistenciesCodeVsDoc?: number` — code-vs-doc inconsistency count
- `inconsistenciesCodeVsCode?: number` — code-vs-code inconsistency count
- `phantomPaths?: number` — phantom path reference count in AGENTS.md files
- `inconsistencyReport?: InconsistencyReport` — full report (undefined if checks didn't run)

**ProgressEvent** emitted by command runners to progress reporters with discriminated `type` field:
- `type: 'start' | 'done' | 'error' | 'dir-done' | 'root-done'` — event type
- `filePath: string` — file or directory path
- `index: number` — zero-based task index in current phase
- `total: number` — total tasks in current phase
- `durationMs?: number` — wall-clock duration (present on `'done'` events)
- `tokensIn?: number` — input tokens consumed (present on `'done'` events)
- `tokensOut?: number` — output tokens generated (present on `'done'` events)
- `model?: string` — model identifier (present on `'done'` events)
- `error?: string` — error message (present on `'error'` events)

**CommandRunOptions** controls command execution behavior populated from config defaults and CLI flags:
- `concurrency: number` — maximum concurrent AI calls
- `failFast?: boolean` — stop pulling tasks on first error
- `debug?: boolean` — show exact prompts sent
- `dryRun?: boolean` — list files without executing
- `tracer?: ITraceWriter` — trace writer for NDJSON event emission (no-op when tracing disabled)
- `progressLog?: ProgressLog` — file-based output mirror for `tail -f` monitoring

## Import Dependencies

Imports `InconsistencyReport` from `../quality/index.js` for quality validation results embedded in RunSummary.

Imports `ProgressLog` from `./progress.js` for file-based progress logging.

Imports `ITraceWriter` from `./trace.js` for NDJSON trace event serialization.

## Event Type Semantics

ProgressEvent carries phase-specific optional fields:
- `'start'` events populate `filePath`, `index`, `total`
- `'done'` events populate `filePath`, `index`, `total`, `durationMs`, `tokensIn`, `tokensOut`, `model`
- `'error'` events populate `filePath`, `index`, `total`, `error`
- `'dir-done'` events populate `filePath` with directory path
- `'root-done'` events populate `filePath` with root document path