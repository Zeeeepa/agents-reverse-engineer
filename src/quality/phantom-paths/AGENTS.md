<!-- Generated by agents-reverse-engineer -->

# src/quality/phantom-paths

Detects unresolvable path references in `AGENTS.md` files by extracting path-like strings via regex patterns, resolving them against both the `AGENTS.md` directory and project root with `.ts`/`.js` fallback logic, and returning `PhantomPathInconsistency` objects for non-existent paths.

## Contents

### [index.ts](./index.ts)
Barrel re-export consolidating `checkPhantomPaths` validator for single import point.

### [validator.ts](./validator.ts)
Core validation logic extracting paths via `PATH_PATTERNS`, resolving with extension fallback, reporting `PhantomPathInconsistency` for unresolved references.

## Exported Interface

- **`checkPhantomPaths(agentsMdPath, content, projectRoot)`** — Validates path references in `AGENTS.md` content, returns `PhantomPathInconsistency[]` with `type: 'phantom-path'`, `severity: 'warning'`, `referencedPath`, `resolvedTo`, and 120-char `context` excerpt

## Path Extraction Patterns

Three regex patterns (`PATH_PATTERNS`) capture references:

```javascript
/\[(?:[^\]]*)\]\((\.[^)]+)\)/g              // Markdown links: [text](./path)
/`((?:src\/|\.\.?\/)[^`]+\.[a-z]{1,4})`/g  // Backtick paths: `src/foo/bar.ts`
/(?:from|in|by|via|see)\s+`?(src\/[\w\-./]+)`?/gi // Prose paths: "from src/foo/"
```

`SKIP_PATTERNS` excludes `node_modules`, `.git/`, URLs (`https?:`), template syntax (`{{`, `${`), glob wildcards (`*`), brace expansions (`{a,b,c}`).

## Resolution Strategy

Attempts resolution in order: (1) relative to `agentsMdDir` via `path.dirname(agentsMdPath)`, (2) relative to `projectRoot`, (3) `.js` → `.ts` substitution for TypeScript import convention. Uses `existsSync()` to validate at least one candidate exists. Deduplicates via `seen` Set tracking `rawPath` strings.

## Integration Context

Part of quality validation subsystem (`src/quality/`) alongside code-vs-doc consistency (`../inconsistency/code-vs-doc.js`) and code-vs-code duplicate detection (`../inconsistency/code-vs-code.js`). Invoked during post-generation validation phase via `src/quality/index.ts` to identify broken path references that may mislead AI coding assistants.