<!-- Generated by agents-reverse-engineer -->

# phantom-paths

Detects and reports references to non-existent file paths in generated AGENTS.md documentation.

## Contents

**[validator.ts](./validator.ts)** — Extracts path-like strings from AGENTS.md content using `PATH_PATTERNS`, resolves against filesystem, and returns `PhantomPathInconsistency[]` for missing files. Employs multi-strategy resolution (relative to AGENTS.md directory, project root, .ts/.js extension substitution) and skip patterns for false positives (node_modules, URLs, template syntax).

**[index.ts](./index.ts)** — Barrel export re-exporting `checkPhantomPaths` from validator.ts as the public interface.

## Behavioral Contracts

### Path Extraction Patterns (`PATH_PATTERNS`)

```regex
/\[(?:[^\]]*)\]\((\.[^)]+)\)/g
```
Matches markdown links: `[text](./path)` or `[text](path)`

```regex
/`((?:src\/|\.\.?\/)[^`]+\.[a-z]{1,4})`/g
```
Matches backtick-quoted paths: `` `src/foo/bar.ts` ``, `` `../foo/bar.js` ``

```regex
/(?:from|in|by|via|see)\s+`?(src\/[\w\-./]+)`?/gi
```
Matches prose path references: "from src/foo/", "in src/foo/bar.ts"

### False Positive Skip Patterns (`SKIP_PATTERNS`)

- `/node_modules/`, `/\.git\//` — dependency and VCS directories
- `/^https?:/` — URLs
- `/\{\{/`, `/\$\{/` — template placeholder and literal syntax
- `/\*/`, `/\{[^}]*,[^}]*\}/` — glob patterns and brace expansion

### Resolution Strategy

For each extracted path:
1. Resolve relative to AGENTS.md directory: `path.resolve(agentsMdDir, rawPath)`
2. Resolve relative to project root: `path.resolve(projectRoot, rawPath)`
3. Try `.js` → `.ts` extension substitution for TypeScript import conventions
4. Use `existsSync()` to verify at least one candidate exists
5. If all fail, emit `PhantomPathInconsistency` with type `'phantom-path'`, severity `'warning'`, 120-character context snippet

## Integration

Called by `src/quality/index.ts` `validateDocQuality()` after AGENTS.md generation. Inconsistencies are aggregated with density and code-vs-doc validators, filtered by severity threshold, and reported via `logInconsistencies()`.