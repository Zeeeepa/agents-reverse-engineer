<!-- Generated by agents-reverse-engineer v1.1.0 -->

# src/quality/phantom-paths

Detects and reports non-existent file paths referenced in `AGENTS.md` files by extracting markdown links, backtick-wrapped paths, and prose references, resolving them against directory and project root, and testing existence with `.js`→`.ts` variant fallback.

## Contents

- **[`index.ts`](./index.ts)**: Barrel export for `checkPhantomPaths` from `./validator.js`.
- **[`validator.ts`](./validator.ts)**: Implements `checkPhantomPaths(agentsMdPath, content, projectRoot)` — extracts path-like strings via `PATH_PATTERNS`, resolves via `path.resolve()` against `agentsMdDir` and `projectRoot`, checks `existsSync()`, returns `PhantomPathInconsistency[]` with `{type: 'phantom-path', severity: 'warning', agentsMdPath, description, details: {referencedPath, resolvedTo, context}}`.

## Path Extraction Patterns

`validator.ts` defines `PATH_PATTERNS` array with three regexes:
1. `/\[(?:[^\]]*)\]\((\.[^)]+)\)/g` — markdown links `[text](./path)`
2. ``/`((?:src\/|\.\.?\/)[^`]+\.[a-z]{1,4})`/g`` — backtick paths ``src/foo/bar.ts`` or ``../foo/bar.js``
3. `/(?:from|in|by|via|see)\s+`?(src\/[\w\-./]+)`?/gi` — prose paths "from src/foo/"

## Exclusion Rules

`SKIP_PATTERNS` filters `/node_modules/`, `/\.git\//`, `/^https?:/`, `/\{\{/` (template placeholders), `/\$\{/` (template literals), `/\*/` (globs), `/\{[^}]*,[^}]*\}/` (brace expansion).

## Resolution Strategy

For each extracted path:
1. Resolve relative to `path.dirname(agentsMdPath)` and `projectRoot`
2. Generate `.js`→`.ts` variants via `replace(/\.js$/, '.ts')`
3. Test all candidates via `fs.existsSync()`
4. Return `PhantomPathInconsistency` with `contextLine` (first line containing `rawPath`, trimmed to 120 chars) if none exist

## Dependencies

`validator.ts` imports `PhantomPathInconsistency` from `../types.js` (type definition for quality check results). Uses Node.js `fs` (`existsSync`), `path` (`resolve`, `dirname`).