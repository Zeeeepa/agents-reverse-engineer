<!-- Generated by agents-reverse-engineer v1.0.1 -->

# src/quality/phantom-paths

Validates path references in AGENTS.md files, detecting non-existent file references using regex extraction and filesystem verification.

## Contents

- [index.ts](./index.ts): Barrel export re-exporting `checkPhantomPaths` from `validator.js`.
- [validator.ts](./validator.ts): Implements `checkPhantomPaths(agentsMdPath, content, projectRoot)` validator that extracts markdown links, backtick paths, and prose paths using `PATH_PATTERNS` regexes, resolves them via `path.resolve()`, verifies existence with `existsSync()`, and returns `PhantomPathInconsistency[]` warnings for missing files.

## Path Extraction Strategy

`PATH_PATTERNS` defines 3 extraction regexes: `/\[(?:[^\]]*)\]\((\.[^)]+)\)/g` for markdown links, `/`((?:src\/|\.\.?\/)[^`]+\.[a-z]{1,4})`/g` for backtick-quoted paths, `/(?:from|in|by|via|see)\s+`?(src\/[\w\-./]+)`?/gi` for prose references. `SKIP_PATTERNS` excludes `node_modules`, `.git/`, `https?:`, `{{`, `${`, `*`, brace expansion syntax.

## Resolution Protocol

For each extracted path, attempts resolution via `path.resolve(agentsMdDir, rawPath)` and `path.resolve(projectRoot, rawPath)`. For `.js` extensions, applies TypeScript fallback by testing `.ts` variants. Returns `PhantomPathInconsistency` with `type: 'phantom-path'`, `severity: 'warning'`, `referencedPath`, `resolvedTo`, and 120-character `context` snippet.

## Behavioral Contracts

**PATH_PATTERNS regexes:**
- Markdown links: `/\[(?:[^\]]*)\]\((\.[^)]+)\)/g`
- Backtick paths: `/`((?:src\/|\.\.?\/)[^`]+\.[a-z]{1,4})`/g`
- Prose paths: `/(?:from|in|by|via|see)\s+`?(src\/[\w\-./]+)`?/gi`

**SKIP_PATTERNS exclusions:** `node_modules`, `.git/`, `https?:`, `{{`, `${`, `*`, `{a,b,c}`.

**TypeScript resolution:** For `.js` extensions, test `.ts` variant via `existsSync()`.

**Inconsistency format:** `type: 'phantom-path'`, `severity: 'warning'`, `referencedPath` (original), `resolvedTo` (absolute), `context` (120-char excerpt).

## Integration

`checkPhantomPaths` returns `PhantomPathInconsistency[]` typed via `../types.js`. Consumed by `src/quality/` module for AGENTS.md validation workflows.