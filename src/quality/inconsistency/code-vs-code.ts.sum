---
generated_at: 2026-02-09T17:44:20.675Z
content_hash: 48a2ef2363302abe6f4b31022b7afa304960c3631294ddbed6bbe3e4b3251a9a
purpose: checkCodeVsCode() detects duplicate export symbols across source files within a scoped group (typically per-directory...
---
**checkCodeVsCode() detects duplicate export symbols across source files within a scoped group (typically per-directory) using heuristic regex-based extraction, flagging symbols exported from multiple files as CodeCodeInconsistency warnings without AST analysis.**

## Exported Function

**checkCodeVsCode(files: Array<{ path: string; content: string }>): CodeCodeInconsistency[]**

Accepts array of file objects with `path` and `content` properties. For each file, invokes `extractExports()` from `code-vs-doc.js` to extract exported symbol names via regex pattern `/^[ \t]*export\s+(?:default\s+)?(?:function|class|const|let|var|type|interface|enum)\s+(\w+)/gm`. Aggregates symbols into `Map<string, string[]>` where key is export name and value is array of file paths exporting that symbol. Returns array of `CodeCodeInconsistency` objects for symbols appearing in more than one file.

## Algorithm

1. Initialize `exportMap` as `Map<string, string[]>` to track symbol-to-paths mapping
2. Iterate each file in input array:
   - Call `extractExports(file.content)` to get exported symbol names
   - For each exported name:
     - If name exists in map, push `file.path` to existing array
     - Otherwise, create new entry with `[file.path]`
3. Iterate exportMap entries:
   - If `paths.length > 1`, construct `CodeCodeInconsistency` object with:
     - `type: 'code-vs-code'`
     - `severity: 'warning'`
     - `files: paths` (all file paths exporting the symbol)
     - `description: "Symbol \"${name}\" exported from ${paths.length} files"`
     - `pattern: 'duplicate-export'`
4. Return accumulated inconsistencies array

## Dependencies

**extractExports()** from `./code-vs-doc.js` — Regex-based export symbol extractor using pattern `/^[ \t]*export\s+(?:default\s+)?(?:function|class|const|let|var|type|interface|enum)\s+(\w+)/gm`

**CodeCodeInconsistency** from `../types.js` — Discriminated union member with `type: 'code-vs-code'`, `severity: 'warning'`, `files: string[]`, `description: string`, `pattern: 'duplicate-export'`

## Usage Context

Caller must scope input files to prevent false positives. Typical usage: per-directory validation in `src/quality/index.ts` where files are grouped by containing directory before invoking `checkCodeVsCode()`. Cross-directory duplicate detection would flag legitimate symbol reuse across unrelated modules (e.g., `index.ts` in multiple directories commonly exports same helper names).

## Known Limitations

Heuristic regex extraction misses:
- Destructured exports: `export const { foo, bar } = obj`
- Namespace exports: `export * as Utils from './utils'`
- Dynamic exports: `export { [computedName]: value }`
- Re-exports with renaming: `export { foo as bar } from './mod'`

No AST analysis to distinguish intentional duplication (e.g., interface/implementation pairs, test fixtures) from architectural violations. Operates purely on symbol name matching without semantic understanding of whether duplicates represent distinct types, overloads, or genuinely conflicting definitions.