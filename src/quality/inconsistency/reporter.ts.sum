---
generated_at: 2026-02-09T13:18:09.748Z
content_hash: 48d4aecccbb0b9df690e33716b28c299a767ac99176e78200e16ec0b7e28a91f
purpose: reporter.ts builds structured InconsistencyReport objects from raw Inconsistency arrays and formats them as plain-tex...
---
**reporter.ts builds structured InconsistencyReport objects from raw Inconsistency arrays and formats them as plain-text CLI output.**

## Exported Functions

`buildInconsistencyReport(issues: Inconsistency[], metadata: { projectRoot: string; filesChecked: number; durationMs: number }): InconsistencyReport` aggregates Inconsistency arrays into typed reports with summary counts (codeVsDoc, codeVsCode, phantomPaths, errors, warnings, info), attaches ISO timestamp via `new Date().toISOString()`, and embeds metadata (projectRoot, filesChecked, durationMs).

`formatReportForCli(report: InconsistencyReport): string` transforms InconsistencyReport into plain-text output with header (`=== Inconsistency Report ===`), summary line (`Checked N files in Nms`), and per-issue blocks with severity tags `[ERROR]`, `[WARN]`, `[INFO]`. Conditionally renders `File:` for code-vs-doc type, `Doc:` and `Path:` for phantom-path type, `Files:` for code-vs-code type.

## Type Dependencies

Imports `Inconsistency` and `InconsistencyReport` from `../types.js`. Inconsistency discriminated union has `type` field ('code-vs-doc' | 'code-vs-code' | 'phantom-path') and `severity` field ('error' | 'warning' | 'info'). InconsistencyReport contains `metadata`, `issues`, and `summary` with count breakdowns.

## Design Constraints

No color dependencies (no picocolors imports) â€” formatReportForCli emits raw plain text so testing stays pure and color injection can happen in CLI layer (src/cli/). Counter loops over issues array incrementing type/severity buckets without external state.