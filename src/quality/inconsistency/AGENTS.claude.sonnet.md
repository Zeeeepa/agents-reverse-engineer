<!-- Generated by agents-reverse-engineer v1.1.0 -->

# src/quality/inconsistency

Heuristic validation detecting export drift between source code and `.sum` documentation, duplicate symbol exports across file groups, and formatting inconsistency reports for CLI/Markdown output.

## Contents

- [`code-vs-code.ts`](./code-vs-code.ts): `checkCodeVsCode` aggregates exported symbols via `extractExports`, emits `CodeCodeInconsistency[]` with `type: 'code-vs-code'`, `severity: 'warning'`, `pattern: 'duplicate-export'` when symbols appear in multiple files.
- [`code-vs-doc.ts`](./code-vs-doc.ts): `extractExports` captures identifiers from `/^[ \t]*export\s+(?:default\s+)?(?:function|class|const|let|var|type|interface|enum)\s+(\w+)/gm`. `checkCodeVsDoc` compares extracted symbols against `SumFileContent.summary` text via case-sensitive `includes`, returns `CodeDocInconsistency | null` with `missingFromDoc` array.
- [`reporter.ts`](./reporter.ts): `buildInconsistencyReport` computes counts by type/severity, attaches run metadata. `formatReportForCli` renders plain-text output with `[ERROR]`/`[WARN]`/`[INFO]` tags and 2-space indented paths. `formatReportAsMarkdown` emits GFM table with backtick-wrapped severity/paths.

## Validation Pipeline

1. **Export Extraction**: `code-vs-doc.ts:extractExports` applies regex to source content, yields identifier array
2. **Code-vs-Doc Check**: `code-vs-doc.ts:checkCodeVsDoc` filters `missingFromDoc` where `!sumContent.summary.includes(exportName)`
3. **Code-vs-Code Check**: `code-vs-code.ts:checkCodeVsCode` builds `Map<exportName, filePath[]>`, flags entries with `paths.length > 1`
4. **Report Generation**: `reporter.ts:buildInconsistencyReport` aggregates issues, `formatReportForCli`/`formatReportAsMarkdown` format output

## Behavioral Contracts

**Export Pattern**: `/^[ \t]*export\s+(?:default\s+)?(?:function|class|const|let|var|type|interface|enum)\s+(\w+)/gm` (multiline, global, captures identifier at group 1)

**CLI Report Header**:
```
=== Inconsistency Report ===
Checked {filesChecked} files in {durationMs}ms
Found {total} issue(s)
```

**Severity Tags**: `[ERROR]`, `[WARN]`, `[INFO]` (bracket-wrapped uppercase)

**Markdown Table Columns**: `Severity | Type | Description | Location` (backtick-wrapped severity codes and paths)

**Symbol Matching**: Case-sensitive `string.includes()` for presence detection in `.sum` summary text