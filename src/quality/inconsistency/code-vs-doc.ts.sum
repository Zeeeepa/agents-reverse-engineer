---
generated_at: 2026-02-09T14:08:15.724Z
content_hash: 20526dbcc3fa83bca2efb8a76027db019b8944ad212cf781c189935bfced0410
purpose: Detects code-vs-doc inconsistencies by extracting exports from TypeScript/JavaScript source and verifying their prese...
---
**Detects code-vs-doc inconsistencies by extracting exports from TypeScript/JavaScript source and verifying their presence in corresponding `.sum` file documentation.**

## Exported Functions

**`extractExports(sourceContent: string): string[]`**
Extracts named and default export identifiers from TypeScript/JavaScript source using regex pattern `/^[ \t]*export\s+(?:default\s+)?(?:function|class|const|let|var|type|interface|enum)\s+(\w+)/gm`. Matches declarations like `export function foo`, `export const BAR`, `export default class App`. Ignores re-exports, commented-out lines, and internal non-exported declarations. Returns array of exported identifier names.

**`checkCodeVsDoc(sourceContent: string, sumContent: SumFileContent, filePath: string): CodeDocInconsistency | null`**
Compares source exports against `.sum` documentation content to detect two inconsistency types: `missingFromDoc` (symbols exported in source but not mentioned in `.sum` text via case-sensitive substring search), and `missingFromCode` (items listed in `publicInterface` with no matching export, though current implementation returns empty array for this field). Returns `CodeDocInconsistency` with `type: 'code-vs-doc'`, `severity: 'warning'`, `filePath`, `sumPath` (constructed as `${filePath}.sum`), `description` (count-based message), and `details` object containing both arrays. Returns `null` when all exports appear in `sumText`.

## Type Dependencies

Imports `SumFileContent` from `../../generation/writers/sum.js` (parsed `.sum` file structure with `summary` field containing documentation text). Imports `CodeDocInconsistency` from `../types.js` (inconsistency report interface with discriminated union `type` field).

## Algorithm Characteristics

Validation uses regex-based export extraction missing complex patterns (destructured exports, namespace exports, dynamic exports). Substring matching via `sumText.includes(e)` yields false negatives when export name appears in prose unrelated to API surface (e.g., "we export the results" mentions "export" but doesn't document the symbol). Operates on raw source strings without AST parsing.

## Integration Points

Called by quality validation orchestrator in Phase 1 file analysis to detect documentation drift during `.sum` generation. Feeds `CodeDocInconsistency` results into `InconsistencyReport` via `src/quality/inconsistency/reporter.ts` aggregation. Works alongside `code-vs-code.ts` (duplicate symbol detection) and `phantom-paths/validator.ts` (path resolution validation).