---
generated_at: 2026-02-09T15:08:05.869Z
content_hash: cf3a2e38893eba8c064f647e2325adb2358162304275fc28ae3760811fbab6fe
purpose: Defines discriminated union types for quality validation results: code-vs-doc export mismatches, code-vs-code duplica...
---
**Defines discriminated union types for quality validation results: code-vs-doc export mismatches, code-vs-code duplicate symbols, phantom path references, and structured inconsistency reports.**

## Type Definitions

### Severity Classification

`InconsistencySeverity` — string union type with literal values `'info' | 'warning' | 'error'` for categorizing validation issues by severity level.

### Inconsistency Types (Discriminated Union)

`CodeDocInconsistency` — interface representing mismatches between source code exports and `.sum` documentation content:
- `type: 'code-vs-doc'` — discriminant field
- `severity: InconsistencySeverity` — issue severity level
- `filePath: string` — source file path
- `sumPath: string` — corresponding `.sum` file path
- `description: string` — human-readable issue summary
- `details.missingFromDoc: string[]` — symbols exported in source but absent from `.sum` content
- `details.missingFromCode: string[]` — symbols mentioned in `.sum` but not found in source exports
- `details.purposeMismatch?: string` — optional purpose statement contradicting observable behavior

`CodeCodeInconsistency` — interface representing conflicts across multiple source files:
- `type: 'code-vs-code'` — discriminant field
- `severity: InconsistencySeverity` — issue severity level
- `files: string[]` — paths to conflicting source files
- `description: string` — human-readable issue summary
- `pattern: string` — detected pattern identifier (e.g., `'duplicate-export'`)

`PhantomPathInconsistency` — interface representing unresolvable path references in generated `AGENTS.md`:
- `type: 'phantom-path'` — discriminant field
- `severity: InconsistencySeverity` — issue severity level
- `agentsMdPath: string` — path to `AGENTS.md` containing phantom reference
- `description: string` — human-readable issue summary
- `details.referencedPath: string` — phantom path as written in document
- `details.resolvedTo: string` — resolution target (project root or AGENTS.md directory)
- `details.context: string` — line containing phantom reference

### Union and Report Types

`Inconsistency` — discriminated union type combining `CodeDocInconsistency | CodeCodeInconsistency | PhantomPathInconsistency` for type-safe issue handling.

`InconsistencyReport` — interface representing structured validation output:
- `metadata.timestamp: string` — ISO 8601 timestamp
- `metadata.projectRoot: string` — absolute path to project root
- `metadata.filesChecked: number` — count of analyzed files
- `metadata.durationMs: number` — validation execution time
- `issues: Inconsistency[]` — array of detected inconsistencies (discriminated union)
- `summary.total: number` — total issue count
- `summary.codeVsDoc: number` — count of `CodeDocInconsistency` issues
- `summary.codeVsCode: number` — count of `CodeCodeInconsistency` issues
- `summary.phantomPaths: number` — count of `PhantomPathInconsistency` issues
- `summary.errors: number` — count of error-severity issues
- `summary.warnings: number` — count of warning-severity issues
- `summary.info: number` — count of info-severity issues

## Integration Points

Consumed by validator implementations in `src/quality/inconsistency/` (code-vs-doc.ts, code-vs-code.ts), `src/quality/phantom-paths/validator.ts`, and reporter in `src/quality/inconsistency/reporter.ts`. Exported via `src/quality/index.ts` as public API for quality validation subsystem.