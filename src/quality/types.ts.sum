---
generated_at: 2026-02-09T21:29:53.485Z
content_hash: cf3a2e38893eba8c064f647e2325adb2358162304275fc28ae3760811fbab6fe
purpose: Defines discriminated union types for quality analysis inconsistency detection and reporting across code-vs-doc, code...
---
**Defines discriminated union types for quality analysis inconsistency detection and reporting across code-vs-doc, code-vs-code, and phantom-path validation domains.**

## Exported Types

**InconsistencySeverity**: String literal union `'info' | 'warning' | 'error'` categorizing inconsistency impact levels.

**CodeDocInconsistency**: Interface with `type: 'code-vs-doc'` discriminant representing mismatches between source code exports and `.sum` documentation content. Contains:
- `severity: InconsistencySeverity`
- `filePath: string` — source file path
- `sumPath: string` — corresponding `.sum` file path
- `description: string`
- `details.missingFromDoc: string[]` — exported symbols absent from `.sum` summary
- `details.missingFromCode: string[]` — symbols mentioned in `.sum` but not found in source
- `details.purposeMismatch?: string` — purpose statement contradicting observable behavior

**CodeCodeInconsistency**: Interface with `type: 'code-vs-code'` discriminant representing conflicts across multiple source files (e.g., duplicate exports). Contains:
- `severity: InconsistencySeverity`
- `files: string[]` — paths to conflicting files
- `description: string`
- `pattern: string` — detected pattern identifier (e.g., `'duplicate-export'`)

**PhantomPathInconsistency**: Interface with `type: 'phantom-path'` discriminant representing unresolvable path references in `AGENTS.md` files. Contains:
- `severity: InconsistencySeverity`
- `agentsMdPath: string` — path to `AGENTS.md` containing phantom reference
- `description: string`
- `details.referencedPath: string` — phantom path as written in document
- `details.resolvedTo: string` — resolution attempt context (project root or `AGENTS.md` location)
- `details.context: string` — line of text containing phantom reference

**Inconsistency**: Discriminated union type `CodeDocInconsistency | CodeCodeInconsistency | PhantomPathInconsistency` enabling exhaustive pattern matching via `type` discriminant.

**InconsistencyReport**: Structured analysis output interface containing:
- `metadata.timestamp: string` — ISO 8601 execution timestamp
- `metadata.projectRoot: string` — absolute project root path
- `metadata.filesChecked: number` — count of analyzed files
- `metadata.durationMs: number` — analysis duration in milliseconds
- `issues: Inconsistency[]` — array of detected inconsistencies
- `summary.total: number` — total inconsistency count
- `summary.codeVsDoc: number` — code-vs-doc inconsistency count
- `summary.codeVsCode: number` — code-vs-code inconsistency count
- `summary.phantomPaths: number` — phantom path inconsistency count
- `summary.errors: number` — error-severity count
- `summary.warnings: number` — warning-severity count
- `summary.info: number` — info-severity count

## Integration Points

Consumed by validators in `src/quality/inconsistency/` (`code-vs-doc.ts`, `code-vs-code.ts`) and `src/quality/phantom-paths/validator.ts` for constructing typed inconsistency objects. `InconsistencyReport` returned by `src/quality/inconsistency/reporter.ts` aggregation logic and logged via `src/orchestration/progress.ts` streaming reporter.