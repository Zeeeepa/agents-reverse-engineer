---
generated_at: 2026-02-09T17:45:49.534Z
content_hash: cf3a2e38893eba8c064f647e2325adb2358162304275fc28ae3760811fbab6fe
purpose: types.ts defines the discriminated union of quality inconsistency types and structured report format for code-documen...
---
**types.ts defines the discriminated union of quality inconsistency types and structured report format for code-documentation validation.**

## Exported Types

**InconsistencySeverity** — String literal union `'info' | 'warning' | 'error'` classifying issue priority.

**CodeDocInconsistency** — Inconsistency between `.sum` documentation and source code exports detected via symbol extraction and substring search. Fields: `type: 'code-vs-doc'`, `severity`, `filePath` (source), `sumPath` (.sum file), `description`, `details.missingFromDoc` (exported symbols absent from .sum), `details.missingFromCode` (symbols in .sum not found in source), `details.purposeMismatch` (optional purpose statement contradiction).

**CodeCodeInconsistency** — Cross-file inconsistency detected by pattern analysis across multiple source files. Fields: `type: 'code-vs-code'`, `severity`, `files` (conflicting paths), `description`, `pattern` (e.g., `'duplicate-export'` for symbols appearing in multiple files).

**PhantomPathInconsistency** — Unresolvable path reference found in `AGENTS.md` via regex extraction and `existsSync()` validation. Fields: `type: 'phantom-path'`, `severity`, `agentsMdPath` (containing document), `description`, `details.referencedPath` (original string from markdown), `details.resolvedTo` (attempted resolution target), `details.context` (surrounding text line).

**Inconsistency** — Discriminated union `CodeDocInconsistency | CodeCodeInconsistency | PhantomPathInconsistency` with `type` discriminator enabling exhaustive pattern matching.

**InconsistencyReport** — Structured quality validation output. Fields: `metadata` containing `timestamp`, `projectRoot`, `filesChecked`, `durationMs`; `issues[]` array of `Inconsistency` instances; `summary` object with `total`, `codeVsDoc`, `codeVsCode`, `phantomPaths`, `errors`, `warnings`, `info` counts.

## Integration Context

Consumed by `src/quality/inconsistency/code-vs-doc.ts` (export extraction + substring validation), `src/quality/inconsistency/code-vs-code.ts` (duplicate symbol detection), `src/quality/phantom-paths/validator.ts` (markdown path resolution), and `src/quality/inconsistency/reporter.ts` (aggregation and summary computation). The `type` discriminator enables type-safe narrowing in switch statements for severity assignment and detail extraction.