---
generated_at: 2026-02-09T14:07:56.014Z
content_hash: 766b567d891820428c3ef97c56fd538afc9041ec7b387958ce79194294ded8e9
purpose: OpenCodeBackend implements the AIBackend interface as a stub adapter for the OpenCode CLI, providing command detectio...
---
**OpenCodeBackend implements the AIBackend interface as a stub adapter for the OpenCode CLI, providing command detection and argument building while throwing AIServiceError on parseResponse until JSONL parsing is implemented.**

## Exported Symbols

**OpenCodeBackend** class implements AIBackend interface with:
- `readonly name: 'opencode'` — Backend identifier string
- `readonly cliCommand: 'opencode'` — CLI executable name
- `async isAvailable(): Promise<boolean>` — Checks PATH for `opencode` command via isCommandOnPath from claude.ts
- `buildArgs(_options: AICallOptions): string[]` — Returns `['run', '--format', 'json']` for CLI invocation
- `parseResponse(_stdout: string, _durationMs: number, _exitCode: number): AIResponse` — Always throws AIServiceError with code 'SUBPROCESS_ERROR' and message directing users to Claude backend
- `getInstallInstructions(): string` — Returns multiline string with curl install command from https://opencode.ai/install

## Implementation Status

OpenCodeBackend is a non-functional stub demonstrating AIBackend extension pattern. The isAvailable and buildArgs methods work but parseResponse throws to prevent execution. Full implementation blocked on OpenCode JSONL output parsing design (referenced as RESEARCH.md Open Question 3 in module docstring). Subprocess wrapper expects prompt on stdin. AIServiceError and AICallOptions imported from '../types.js', isCommandOnPath shared utility imported from './claude.js'.

## Integration Points

Part of AI backend registry system alongside ClaudeBackend and GeminiBackend. AIService in src/ai/service.ts routes to OpenCodeBackend when config specifies backend: 'opencode' or when auto-detection finds opencode CLI first. The buildArgs output passes to runSubprocess in src/ai/subprocess.ts which spawns execFile child process with stdin streaming.