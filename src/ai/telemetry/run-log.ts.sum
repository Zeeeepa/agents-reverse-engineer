---
generated_at: 2026-02-09T21:27:45.637Z
content_hash: 885090812a3be24de9212805ef4c0d2b922fe78af57830769f591dd57f88ba4b
purpose: writeRunLog() serializes completed RunLog objects to pretty-printed JSON files in `.agents-reverse-engineer/logs/` wi...
---
**writeRunLog() serializes completed RunLog objects to pretty-printed JSON files in `.agents-reverse-engineer/logs/` with ISO timestamp-derived filenames.**

## Exported Functions

**writeRunLog(projectRoot: string, runLog: RunLog): Promise<string>**

Writes a completed RunLog to disk as pretty-printed JSON (2-space indentation). Creates `.agents-reverse-engineer/logs/` directory via `fs.mkdir()` with `recursive: true` if absent. Derives filename from `runLog.startTime` by replacing `:` and `.` characters with `-` to ensure cross-platform filesystem compatibility. Returns absolute path to written file. Pattern: `run-${safeTimestamp}.json` where `safeTimestamp` transforms `2026-02-07T12:00:00.000Z` → `2026-02-07T12-00-00-000Z`.

## Constants

**LOGS_DIR**: `'.agents-reverse-engineer/logs'`

Relative path from project root to telemetry log directory.

## Dependencies

- `node:fs/promises`: Async `mkdir()` and `writeFile()` operations
- `node:path`: Path joining via `path.join()`
- `RunLog` type from `../types.js`: Telemetry run log schema with `startTime` (ISO 8601 string), token counts, costs, errors, filesRead metadata

## Integration Points

Called by `TelemetryLogger.endRun()` in `src/ai/telemetry/logger.ts` after aggregating all AIServiceCall results from a generation/update run. Paired with `cleanupOldLogs()` from `src/ai/telemetry/cleanup.ts` which enforces retention limits by deleting oldest run-*.json files beyond configured threshold.

## Behavioral Contracts

Filename transformation: `runLog.startTime.replace(/[:.]/g, '-')` converts ISO 8601 timestamps with colons and periods into filesystem-safe format. Example: `2026-02-07T12:00:00.000Z` → `run-2026-02-07T12-00-00-000Z.json`.