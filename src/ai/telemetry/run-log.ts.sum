---
generated_at: 2026-02-09T17:43:55.788Z
content_hash: 885090812a3be24de9212805ef4c0d2b922fe78af57830769f591dd57f88ba4b
purpose: run-log.ts persists completed AI telemetry RunLog objects as pretty-printed JSON files in `.agents-reverse-engineer/l...
---
**run-log.ts persists completed AI telemetry RunLog objects as pretty-printed JSON files in `.agents-reverse-engineer/logs/` with ISO-8601-derived filenames.**

## Exported Functions

### writeRunLog

```typescript
async function writeRunLog(projectRoot: string, runLog: RunLog): Promise<string>
```

Writes a completed `RunLog` to disk as pretty-printed JSON (2-space indentation). Creates `<projectRoot>/.agents-reverse-engineer/logs/` directory via `fs.mkdir(logsDir, { recursive: true })` if missing. Derives filename from `runLog.startTime` by replacing `:` and `.` characters with `-` to ensure cross-platform filesystem compatibility, producing pattern `run-2026-02-07T12-00-00-000Z.json`. Returns absolute path to written file.

## Constants

`LOGS_DIR` — String constant `'.agents-reverse-engineer/logs'` defining relative path from project root to telemetry log storage directory.

## Dependencies

- `node:fs/promises` — Async file operations (`mkdir`, `writeFile`)
- `node:path` — Path manipulation (`join`)
- `../types.js` — Imports `RunLog` type interface

## Integration Points

Consumed by telemetry logger (`src/ai/telemetry/logger.ts`) during AIService call completion to persist aggregated token counts, costs, durations, and file metadata. Output files feed into retention management via cleanup utilities (`src/ai/telemetry/cleanup.ts`) enforcing `keepRuns` limits from configuration schema.