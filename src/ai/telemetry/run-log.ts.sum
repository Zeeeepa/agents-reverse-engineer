---
generated_at: 2026-02-09T14:07:54.669Z
content_hash: 885090812a3be24de9212805ef4c0d2b922fe78af57830769f591dd57f88ba4b
purpose: `run-log.ts` serializes completed `RunLog` telemetry data to disk as pretty-printed JSON files in `.agents-reverse-en...
---
**`run-log.ts` serializes completed `RunLog` telemetry data to disk as pretty-printed JSON files in `.agents-reverse-engineer/logs/` with ISO-timestamp-derived filenames.**

## Exported Functions

**`writeRunLog(projectRoot: string, runLog: RunLog): Promise<string>`** — Creates logs directory via `fs.mkdir()` with `recursive: true`, sanitizes `runLog.startTime` by replacing `:` and `.` with `-` to form valid cross-platform filename `run-${safeTimestamp}.json`, writes JSON via `fs.writeFile()` with 2-space indentation, returns absolute path to written file.

## Integration Points

**Dependency on `RunLog` type** — Imports `RunLog` from `../types.js`, expects structured telemetry data with `startTime` field (ISO 8601 string) and arbitrary payload fields for token counts, costs, errors, file metadata.

**Consumed by telemetry system** — Called after AI generation run completes to persist aggregated metrics. Pairs with cleanup logic in `src/ai/telemetry/cleanup.ts` which enforces retention limits via `cleanupOldLogs(keepCount)`.

## File Path Construction

**Constants** — `LOGS_DIR` hardcoded as `.agents-reverse-engineer/logs` relative to project root.

**Filename sanitization** — Uses `String.prototype.replace(/[:.]/g, '-')` on ISO timestamp to convert `2026-02-07T12:00:00.000Z` → `2026-02-07T12-00-00-000Z`, ensuring Windows/POSIX compatibility by removing filesystem-unsafe characters.

## Error Handling

**No explicit error handling** — Allows `fs.mkdir()` and `fs.writeFile()` exceptions to propagate to caller. Parent orchestration layers handle I/O failures.