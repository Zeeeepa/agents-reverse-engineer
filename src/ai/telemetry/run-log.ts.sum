---
generated_at: 2026-02-09T15:05:48.440Z
content_hash: 885090812a3be24de9212805ef4c0d2b922fe78af57830769f591dd57f88ba4b
purpose: writeRunLog() serializes completed RunLog objects to timestamped JSON files in `.agents-reverse-engineer/logs/` for t...
---
**writeRunLog() serializes completed RunLog objects to timestamped JSON files in `.agents-reverse-engineer/logs/` for telemetry persistence.**

## Exports

- `writeRunLog(projectRoot: string, runLog: RunLog): Promise<string>` — Creates logs directory via `fs.mkdir()` with `recursive: true`, derives filename from `runLog.startTime` by replacing `:` and `.` with `-` (pattern: `run-${safeTimestamp}.json`), writes pretty-printed JSON via `JSON.stringify(runLog, null, 2)`, returns absolute path to written file.

## Constants

- `LOGS_DIR = '.agents-reverse-engineer/logs'` — Relative path segment for telemetry log storage.

## Filename Sanitization

Replaces `:` and `.` characters in ISO 8601 timestamps via `/[:.]/g` regex to produce valid cross-platform filenames (e.g., `2026-02-07T12:00:00.000Z` → `run-2026-02-07T12-00-00-000Z.json`).

## Integration Points

Consumes `RunLog` type from `../types.js` (sibling telemetry module). Used by telemetry logger (`src/ai/telemetry/logger.ts`) to persist aggregated run metadata after command completion. Works with cleanup module (`src/ai/telemetry/cleanup.ts`) which enforces retention limits on written log files.

## File I/O Pattern

Single atomic write operation per run log with no locking or serialization required (unlike trace writer's promise-chain pattern) because each run produces unique timestamped filename with no concurrent write conflicts.