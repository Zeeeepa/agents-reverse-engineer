---
generated_at: 2026-02-09T17:43:56.303Z
content_hash: 25f1c6c8f5b0d5b82c8b107a6c4714f4b553092e58c74a5e09e7e4f24745533e
purpose: cleanupOldLogs removes expired telemetry run logs from `.agents-reverse-engineer/logs/` by lexicographic timestamp so...
---
**cleanupOldLogs removes expired telemetry run logs from `.agents-reverse-engineer/logs/` by lexicographic timestamp sorting.**

## Exported Function

`cleanupOldLogs(projectRoot: string, keepCount: number): Promise<number>` deletes telemetry log files exceeding retention limit. Returns count of deleted files. Scans `LOGS_DIR` (`'.agents-reverse-engineer/logs'`) for files matching pattern `run-*.json`, sorts lexicographically in reverse order (newest first via ISO 8601 timestamp filenames), slices array at `keepCount` index to identify deletion candidates, unlinks each file via `fs.unlink()`, returns `toDelete.length`. Returns `0` when logs directory does not exist (`ENOENT` error code). Throws on other filesystem errors.

## Algorithm

Reads directory entries with `fs.readdir(logsDir)`, filters for files where `name.startsWith('run-')` and `name.endsWith('.json')`, applies `entries.sort()` followed by `entries.reverse()` for descending lexicographic order, extracts slice `entries.slice(keepCount)` as deletion targets, iterates over `toDelete` array executing `fs.unlink(path.join(logsDir, filename))` for each entry.

## Integration Point

Called by `TelemetryLogger` after writing run logs to enforce retention policy specified in `config.ai.telemetry.keepRuns` (default 50). Prevents unbounded log accumulation during repeated `are generate` and `are update` operations.

## Directory Constant

`LOGS_DIR` constant defines relative path `'.agents-reverse-engineer/logs'` joined with `projectRoot` via `path.join()` to compute absolute directory path.