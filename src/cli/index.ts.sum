---
generated_at: 2026-02-09T14:25:28.384Z
content_hash: f0e637c7e8763bd45f0698a292161427c5f42d9a3820aecfdf74d9759b6fafc8
purpose: CLI entry point routing command-line arguments to subcommand handlers (init, discover, generate, update, specify, cle...
---
**CLI entry point routing command-line arguments to subcommand handlers (init, discover, generate, update, specify, clean, install, uninstall) with flag parsing, version display, and installer invocation.**

## Exported Functions

`main()` parses `process.argv` via `parseArgs()`, handles global flags (`--help`, `--version`), routes commands to handlers, launches interactive installer when invoked with no arguments, and catches uncaught errors to exit with status code 1.

`parseArgs(args: string[])` extracts command name, positional arguments, flag set (`Set<string>`), and key-value pairs (`Map<string, string>`) from argument array. Handles short flags (`-h` → `help`, `-g` → `global`, `-l` → `local`, `-V` → `version`) and long flags with optional values (`--concurrency 3`).

## Command Routing

**init**: Calls `initCommand(positional[0] || '.', { force: flags.has('force') })` to create `.agents-reverse-engineer/config.yaml`.

**discover**: Calls `discoverCommand(positional[0] || '.', {})` to scan files and write `GENERATION-PLAN.md`.

**generate**: Constructs `GenerateOptions` with `dryRun`, `concurrency`, `failFast`, `debug`, `trace` flags, passes to `generateCommand()`.

**update**: Constructs `UpdateCommandOptions` with `uncommitted`, `dryRun`, `concurrency`, `failFast`, `debug`, `trace` flags, passes to `updateCommand()`.

**specify**: Constructs `SpecifyOptions` with `output`, `force`, `dryRun`, `multiFile`, `debug`, `trace` flags, passes to `specifyCommand()`.

**clean**: Constructs `CleanOptions` with `dryRun` flag, passes to `cleanCommand()`.

**install**: Re-parses arguments via `parseInstallerArgs(args)`, passes to `runInstaller()`.

**uninstall**: Re-parses arguments via `parseInstallerArgs(args)`, sets `installerArgs.uninstall = true`, passes to `runInstaller()`.

## Installer Detection

`hasInstallerFlags(flags: Set<string>, values: Map<string, string>)` returns true when `global`, `local`, `force` flags or `runtime` value present, enabling direct installer invocation (`npx agents-reverse-engineer --runtime claude -g`) without explicit `install` command.

Interactive installer launched when `args.length === 0` via `runInstaller({ global: false, local: false, uninstall: false, force: false, help: false, quiet: false })`.

## Version and Help

`showVersion()` prints `agents-reverse-engineer v${VERSION}` from `getVersion()` and exits with code 0.

`showVersionBanner()` prints version without exiting, called before command execution.

`showHelp()` prints `USAGE` constant containing command list, option descriptions, examples, and exits with code 0.

`showUnknownCommand(command: string)` prints error message with command name and exits with code 1.

## Imports

Imports command handlers: `initCommand`, `discoverCommand`, `generateCommand`, `updateCommand`, `cleanCommand`, `specifyCommand`.

Imports option types: `GenerateOptions`, `UpdateCommandOptions`, `CleanOptions`, `SpecifyOptions`.

Imports installer: `runInstaller`, `parseInstallerArgs`.

Imports `getVersion()` from `../version.js` for `VERSION` constant.

## Shebang

`#!/usr/bin/env node` enables direct execution via `are` binary (defined in `package.json` `bin` field mapping to `dist/cli/index.js`).