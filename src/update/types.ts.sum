---
generated_at: 2026-02-09T14:09:58.278Z
content_hash: 7c45f747a3c815a11629fab142997544da6ffc1f850dce8a181dc9a6b8fe78d4
purpose: Defines TypeScript interfaces for incremental update workflow, specifying update operation options, results, progress...
---
**Defines TypeScript interfaces for incremental update workflow, specifying update operation options, results, progress callbacks, and cleanup outcomes.**

## Exported Interfaces

**CleanupResult** — Output of orphan cleanup operation containing:
- `deletedSumFiles: string[]` — Paths of removed `.sum` files
- `deletedAgentsMd: string[]` — Paths of removed `AGENTS.md` files from empty directories

**UpdateOptions** — Configuration for update command:
- `includeUncommitted?: boolean` — Merge staged and working directory changes into detection
- `dryRun?: boolean` — Preview mode without writing changes

**UpdateResult** — Complete outcome of update run containing:
- `analyzedFiles: string[]` — Files processed (added or modified status)
- `skippedFiles: string[]` — Files excluded due to matching content hashes
- `cleanup: CleanupResult` — Orphan deletion summary
- `regeneratedDirs: string[]` — Directories with rewritten `AGENTS.md`
- `baseCommit: string` — Git SHA at update start
- `currentCommit: string` — Git SHA at update end
- `dryRun: boolean` — Whether operation was preview-only

**UpdateProgress** — Optional callbacks for streaming update status:
- `onFileStart?: (path: string, status: 'analyzing' | 'skipping') => void` — Fires before processing file
- `onFileDone?: (path: string, status: 'analyzed' | 'skipped' | 'error') => void` — Fires after processing file
- `onCleanup?: (path: string, type: 'sum' | 'agents-md') => void` — Fires on file deletion
- `onDirRegenerate?: (path: string) => void` — Fires when directory `AGENTS.md` regenerated

## Integration Points

Imports `FileChange` from `../change-detection/types.js` to connect update workflow with git-based delta detection and SHA-256 hash comparison system.