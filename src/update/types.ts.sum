---
generated_at: 2026-02-09T17:46:03.960Z
content_hash: 7c45f747a3c815a11629fab142997544da6ffc1f850dce8a181dc9a6b8fe78d4
purpose: Defines TypeScript interfaces for incremental update workflow including change results, cleanup tracking, progress ca...
---
**Defines TypeScript interfaces for incremental update workflow including change results, cleanup tracking, progress callbacks, and dry-run configuration.**

## Exported Interfaces

`CleanupResult` tracks orphan cleanup outcomes with two fields:
- `deletedSumFiles: string[]` — paths of removed `.sum` files
- `deletedAgentsMd: string[]` — paths of removed `AGENTS.md` files from empty directories

`UpdateOptions` configures update command behavior:
- `includeUncommitted?: boolean` — merge staged and working directory changes into detection
- `dryRun?: boolean` — preview changes without writing files

`UpdateResult` aggregates update execution outcomes:
- `analyzedFiles: string[]` — files regenerated due to added/modified status
- `skippedFiles: string[]` — files with matching `content_hash` in frontmatter
- `cleanup: CleanupResult` — orphan deletion summary
- `regeneratedDirs: string[]` — directories whose `AGENTS.md` was rewritten
- `baseCommit: string` — git SHA at update start
- `currentCommit: string` — git SHA at update end
- `dryRun: boolean` — whether execution was preview-only

`UpdateProgress` provides lifecycle callbacks for streaming progress:
- `onFileStart?: (path: string, status: 'analyzing' | 'skipping') => void` — invoked before processing file
- `onFileDone?: (path: string, status: 'analyzed' | 'skipped' | 'error') => void` — invoked after file completion
- `onCleanup?: (path: string, type: 'sum' | 'agents-md') => void` — invoked when orphan deleted
- `onDirRegenerate?: (path: string) => void` — invoked when directory `AGENTS.md` regenerated

## Dependencies

Imports `FileChange` from `../change-detection/types.js` to represent added/modified/deleted/renamed file states with `status` discriminator and optional `oldPath` for renames.