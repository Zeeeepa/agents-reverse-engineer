<!-- Generated by agents-reverse-engineer v1.0.1 -->

# src/imports

The `src/imports` module extracts and classifies TypeScript/JavaScript import statements from source files, providing structured import data for LLM context building and cross-module reference mapping.

## Contents

- [`extractor.ts`](./extractor.ts): Implements `extractImports(sourceContent)`, `extractDirectoryImports(dirPath, fileNames)`, and `formatImportMap(fileImports)` to parse import statements via `IMPORT_REGEX`, classify as internal/external, and format for LLM prompts.
- [`types.ts`](./types.ts): Defines `ImportEntry` interface with `specifier`, `symbols[]`, `typeOnly` fields, and `FileImports` interface with `fileName`, `externalImports`, `internalImports` fields.
- [`index.ts`](./index.ts): Re-exports `extractImports`, `extractDirectoryImports`, `formatImportMap`, `ImportEntry`, `FileImports` as public module interface.

## Data Flow

1. `extractImports(sourceContent)` applies `IMPORT_REGEX` to source text, returns `ImportEntry[]` with parsed specifiers/symbols/typeOnly flags.
2. `extractDirectoryImports(dirPath, fileNames)` reads first 100 lines of each file, invokes `extractImports()`, classifies entries as internal (`./` prefix) or external (`../` prefix), filters out `node:` builtins and bare npm specifiers, returns `FileImports[]`.
3. `formatImportMap(fileImports)` renders `FileImports[]` as structured text: `fileName:\n  specifier → symbols (type)`.

## Integration Points

Consumed by:
- `src/generation/prompts/builder.ts` — embeds import maps in LLM context via `formatImportMap()`
- `src/quality/phantom-paths/validator.ts` — validates cross-module references against extracted imports

Depends on:
- Node.js `fs.promises` for file I/O
- `path` module for resolving directory paths

## Behavioral Contracts

**IMPORT_REGEX**: `/^import\s+(type\s+)?(?:\{([^}]*)\}|(\*\s+as\s+\w+)|(\w+))\s+from\s+['"]([^'"]+)['"]/gm`
- Group 1: `type` keyword (optional)
- Group 2: Named imports `{Foo, Bar}`
- Group 3: Namespace import `* as name`
- Group 4: Default import
- Group 5: Module specifier

**Classification Rules**:
- Internal: specifier starts with `./`
- External: specifier starts with `../`
- Excluded: specifier starts with `node:` or lacks path prefix (bare npm specifier)

**File Sampling**: `extractDirectoryImports()` reads only first 100 lines per file for performance.