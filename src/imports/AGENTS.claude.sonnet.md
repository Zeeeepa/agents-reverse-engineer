<!-- Generated by agents-reverse-engineer v1.1.0 -->

# src/imports

Parses TypeScript/JavaScript import statements from source files and formats them into structured maps for LLM prompt injection, enabling context-aware documentation generation by capturing intra-directory and cross-module dependencies.

## Contents

- [`extractor.ts`](./extractor.ts): Exports `extractImports` (regex-based import line parser producing `{specifier, symbols, typeOnly}` entries), `extractDirectoryImports` (reads first 100 lines per file, partitions relative imports into `internalImports` (`./`) and `externalImports` (`../`), skips `node:` builtins and bare npm specifiers), `formatImportMap` (renders `fileName: → specifier → symbols (type)` text blocks for LLM prompts).
- [`index.ts`](./index.ts): Re-exports `extractImports`, `extractDirectoryImports`, `formatImportMap` from `./extractor.js` and `ImportEntry`, `FileImports` from `./types.js`.
- [`types.ts`](./types.ts): Defines `ImportEntry` (`{specifier: string, symbols: string[], typeOnly: boolean}`) and `FileImports` (`{fileName: string, externalImports: ImportEntry[], internalImports: ImportEntry[]}`).

## Data Flow

1. **Source Parsing**: `extractImports` applies `IMPORT_REGEX` to source text, captures named/namespace/default imports with type-only flags
2. **Directory Aggregation**: `extractDirectoryImports` reads file chunks (100 lines), invokes `extractImports`, classifies specifiers by path prefix (`.` vs `..`)
3. **Prompt Injection**: `formatImportMap` serializes `FileImports[]` into text blocks consumed by `src/generation/prompts/builder.ts`

## Integration Points

- **Upstream Consumer**: `src/generation/prompts/builder.ts` calls `extractDirectoryImports` with directory path and file list, injects `formatImportMap` output into directory-level prompts
- **Type Dependencies**: `src/generation/types.ts` and `src/orchestration/types.ts` reference `FileImports` for import map storage in file metadata

## Behavioral Contracts

**Import Regex**: `/^import\s+(type\s+)?(?:\{([^}]*)\}|(\*\s+as\s+\w+)|(\w+))\s+from\s+['"]([^'"]+)['"]/gm`
- Group 1: `type` keyword flag
- Group 2: Named symbols in braces (`{foo, bar}`)
- Group 3: Namespace import (`* as name`)
- Group 4: Default import
- Group 5: Module specifier

**Specifier Classification**:
- `internalImports`: specifiers matching `/^\.\/|^\.\$/`
- `externalImports`: specifiers matching `/^\.\.\//`
- Excluded: `node:` builtins, bare npm specifiers (no leading `.` or `..`)

**File Read Limit**: 100 lines per file (first chunk only)

**Output Format** (from `formatImportMap`):
```
fileName.ts:
  ./local.js → namedExport (value)
  ../parent/module.js → TypeName (type)
```