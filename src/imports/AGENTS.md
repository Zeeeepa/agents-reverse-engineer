<!-- Generated by agents-reverse-engineer -->

# src/imports/

Static import analysis subsystem extracting TypeScript/JavaScript import statements via regex parsing to construct dependency graphs consumed by Phase 1 file analysis and Phase 2 directory aggregation prompts.

## Contents

### [extractor.ts](./extractor.ts)
Regex-based parser matching static import statements via `IMPORT_REGEX` (`/^import\s+(type\s+)?(?:\{([^}]*)\}|(\*\s+as\s+\w+)|(\w+))\s+from\s+['"]([^'"]+)['"]/gm`). Exports `extractImports()` returning `ImportEntry[]` with `specifier`, `symbols[]`, `typeOnly` fields. Exports `extractDirectoryImports()` reading first 100 lines per file, classifying imports as `internal` (`./` prefix) or `external` (`../` prefix), filtering bare package specifiers and `node:` built-ins. Exports `formatImportMap()` converting `FileImports[]` to human-readable text blocks for LLM prompt embedding.

### [types.ts](./types.ts)
Defines `ImportEntry` interface with `specifier: string`, `symbols: string[]`, `typeOnly: boolean` representing single import statement. Defines `FileImports` interface with `fileName: string`, `externalImports: ImportEntry[]`, `internalImports: ImportEntry[]` partitioning imports by locality.

### [index.ts](./index.ts)
Barrel export re-exporting `extractImports`, `extractDirectoryImports`, `formatImportMap` from `extractor.ts` and `ImportEntry`, `FileImports` from `types.ts`.

## Data Flow

1. **File Analysis (Phase 1):** `extractDirectoryImports()` invoked by `src/generation/prompts/builder.ts` → reads first 100 lines per source file → applies `IMPORT_REGEX` → classifies imports by locality → returns `FileImports[]`
2. **Prompt Embedding:** `formatImportMap()` serializes `FileImports[]` → produces text block with filename headers and indented specifier-symbol pairs → embedded in AI prompts via `buildFileAnalysisPrompt()`
3. **Directory Aggregation (Phase 2):** Import maps from child files aggregated during directory-level `AGENTS.md` generation to provide cross-module dependency context

## Import Classification

| Category | Pattern | Included | Purpose |
|----------|---------|----------|---------|
| **Internal** | `./filename` | Yes | Same-directory coupling (tight cohesion signals) |
| **External** | `../path/module` | Yes | Cross-directory dependencies (module boundaries) |
| **Package** | `'react'` | No | Third-party npm dependencies (not project structure) |
| **Built-in** | `'node:fs'` | No | Runtime APIs (not project structure) |

## Performance Optimization

Reads only first 100 lines per file via `content.split('\n').slice(0, 100).join('\n')` before regex matching, assuming ES module convention of top-level imports. Skips unreadable files silently via empty catch blocks in `extractDirectoryImports()`.

## Integration Points

- **Consumed by:** `src/generation/prompts/builder.ts` embeds import maps in file analysis prompts via `extractDirectoryImports()` + `formatImportMap()`
- **Prompts:** `src/generation/prompts/templates.ts` includes import map sections in Phase 1 file analysis and Phase 2 directory aggregation templates
- **Output format:** Human-readable text blocks with filename headers (`external imports from foo.ts:`) and indented specifier-symbol pairs (`  ../ai/index.js → AIService`)