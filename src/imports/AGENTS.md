<!-- Generated by agents-reverse-engineer -->

# src/imports

This directory extracts and classifies TypeScript/JavaScript import statements from source files to construct module dependency maps for LLM prompt injection, enabling AI-generated documentation to reference cross-file relationships accurately.

## Contents

### Core Extraction

**[extractor.ts](./extractor.ts)** — Implements `extractImports(sourceContent: string): ImportEntry[]` using `IMPORT_REGEX` to parse import statements with five capture groups (type keyword, named symbols, namespace, default, specifier), `extractDirectoryImports(dirPath: string, fileNames: string[]): Promise<FileImports[]>` to read first 100 lines of each file and classify relative imports as internal (`./`) or external (`../`), and `formatImportMap(fileImports: FileImports[]): string` to serialize dependency data for LLM prompts.

**[types.ts](./types.ts)** — Defines `ImportEntry` interface with `specifier: string`, `symbols: string[]`, and `typeOnly: boolean` fields, and `FileImports` interface with `fileName: string`, `externalImports: ImportEntry[]`, and `internalImports: ImportEntry[]` properties to represent per-file dependency classification.

**[index.ts](./index.ts)** — Barrel export re-exposing `extractImports`, `extractDirectoryImports`, `formatImportMap` from `./extractor.js` and `ImportEntry`, `FileImports` types from `./types.js` as public API consumed by `src/generation/orchestrator.ts`.

## Behavioral Contracts

### Import Statement Parsing

`IMPORT_REGEX` pattern: `/^import\s+(type\s+)?(?:\{([^}]*)\}|(\*\s+as\s+\w+)|(\w+))\s+from\s+['"]([^'"]+)['"]/gm`

Capture groups: `(type\s+)?` → type-only flag, `\{([^}]*)\}` → named symbols, `(\*\s+as\s+\w+)` → namespace import, `(\w+)` → default import, `['"]([^'"]+)['"]` → module specifier.

Named symbol cleaning: `.replace(/\s+as\s+\w+/, '')` removes alias syntax before symbol extraction.

### Import Classification Rules

Internal imports: `i.specifier.startsWith('./')` identifies same-directory dependencies.

External imports: `i.specifier.startsWith('../')` identifies parent/sibling directory dependencies.

Exclusion filter: Bare specifiers (npm packages) and `node:` built-ins filtered out via `.startsWith('.')` check.

### Performance Constraints

File reading limit: `.slice(0, 100)` restricts analysis to first 100 lines since imports are typically at file top.

Silent failure handling: Empty catch blocks skip unreadable files without blocking extraction pipeline.

## Integration with Generation Pipeline

`extractDirectoryImports()` output feeds `formatImportMap()` which produces structured text blocks injected into LLM system prompts by `../generation/prompts/builder.ts`, providing cross-file dependency context when `../generation/orchestrator.ts` generates directory-level `AGENTS.md` files.

Classification into `externalImports` vs `internalImports` enables dependency graph analysis for module coupling metrics and informs post-order directory traversal in `../generation/orchestrator.ts` to ensure parent directories are documented after their children.