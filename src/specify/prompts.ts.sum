---
generated_at: 2026-02-09T15:08:09.558Z
content_hash: 4271916e75010aa5b51ca125d4bfb2e89ea3ce4d8acabfa0cfc9f647a8837e96
purpose: prompts.ts defines the AI prompt infrastructure for project specification synthesis, providing `buildSpecPrompt()` to...
---
**prompts.ts defines the AI prompt infrastructure for project specification synthesis, providing `buildSpecPrompt()` to generate system and user prompts from collected AGENTS.md files with mandatory concern-based organization rules.**

## Exported Types

`SpecPrompt` interface defines prompt pair structure with `system: string` and `user: string` properties for AI-driven specification generation.

## Exported Constants

`SPEC_SYSTEM_PROMPT` constant contains system-level instructions enforcing conceptual grouping by concern (not directory structure), prohibiting folder-mirroring and exact file path prescription, targeting AI agent consumption with nine mandatory sections:
1. Project Overview (purpose, tech stack with versions)
2. Architecture (module boundaries, data flow, design decisions)
3. Public API Surface (exported interfaces, full type signatures)
4. Data Structures & State (types, schemas, state management)
5. Configuration (options, types, defaults, validation, env vars)
6. Dependencies (each with exact version and rationale)
7. Behavioral Contracts (error handling, retry logic, concurrency, lifecycle hooks)
8. Test Contracts (per-module scenarios, edge cases, expected behaviors)
9. Build Plan (phased implementation with dependency ordering)

## Exported Functions

`buildSpecPrompt(docs: AgentsDocs): SpecPrompt` constructs prompt pair by:
- Mapping `docs` array to markdown sections via `### ${doc.relativePath}\n\n${doc.content}` template
- Building `userSections` array with header `Generate a comprehensive project specification from the following documentation.`
- Injecting `## AGENTS.md Files (${docs.length} directories)` section with all `agentsSections`
- Appending `## Output Requirements` section reiterating nine mandatory specification sections
- Enforcing raw markdown output constraint: `Output ONLY the markdown content. No preamble.`
- Returning `{ system: SPEC_SYSTEM_PROMPT, user: userSections.join('\n') }`

## Dependencies

Imports `AgentsDocs` type from `../generation/collector.js` for typed AGENTS.md document array consumed by `buildSpecPrompt()`.

## Design Constraints

Prompt engineering rules enforce MODULE BOUNDARY descriptions over file path prescriptions, exact function/type/constant name preservation from documentation, FULL type signature inclusion (parameters, return types, generics), prohibition of directory name section headings, version number requirements for ALL external dependencies, explicit dependency ordering in Build Plan phases, and exact error type/code specification in Behavioral Contracts.