---
generated_at: 2026-02-09T16:11:28.224Z
content_hash: 34836e7b21ee372f71361b50aaa9e8e19948e339aef640a828b1d1257beac09a
purpose: are-session-end.js spawns detached background `npx agents-reverse-engineer@latest update --quiet` subprocess when ses...
---
**are-session-end.js spawns detached background `npx agents-reverse-engineer@latest update --quiet` subprocess when session ends if uncommitted git changes detected, with disable mechanisms via `ARE_DISABLE_HOOK=1` environment variable or `hook_enabled: false` config substring match.**

## Hook Lifecycle Integration

Executes during SessionEnd event in Claude Code/Gemini CLI runtime. Designed to terminate quickly without blocking session close via detached subprocess pattern.

## Disable Mechanisms

Exits silently (status 0) if `process.env.ARE_DISABLE_HOOK === '1'` before performing any filesystem or git operations.

Reads `.agents-reverse-engineer.yaml` via `existsSync()` and `readFileSync(configPath, 'utf-8')`, performs substring search for `'hook_enabled: false'` (no YAML parser) and exits if match found.

## Change Detection Strategy

Invokes `execSync('git status --porcelain', { encoding: 'utf-8' })` to obtain working tree status. Exits silently if output is empty string after `trim()` (no changes since last commit) or if command throws (non-git repo, git unavailable).

## Background Update Spawn

Calls `spawn('npx', ['agents-reverse-engineer@latest', 'update', '--quiet'], { stdio: 'ignore', detached: true })` to execute incremental update workflow. Child process detached from parent via `detached: true` and unreferenced via `child.unref()` to allow parent exit without waiting for completion.

Uses `stdio: 'ignore'` to suppress all output streams, preventing stdio inheritance that could block session close.

## Execution Environment

Shebang `#!/usr/bin/env node` enables direct execution as script. Imports `execSync`, `spawn` from `'child_process'` module and `existsSync`, `readFileSync` from `'fs'` module using ES module syntax.

No error handling for spawn failureâ€”detached process errors are silently lost due to `stdio: 'ignore'`.