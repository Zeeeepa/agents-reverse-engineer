---
generated_at: 2026-02-09T14:10:04.115Z
content_hash: a40783828dd9498fd985c6549a5633cdcc281a734dbad7cd209d46861ee350be
purpose: build-hooks.js copies hook source files from hooks/ to hooks/dist/ during npm prepublishOnly lifecycle.
---
**build-hooks.js copies hook source files from hooks/ to hooks/dist/ during npm prepublishOnly lifecycle.**

## Execution Context

Invoked via `npm run build:hooks` and automatically called by `npm run prepublishOnly` after TypeScript compilation. Uses ES module syntax with Node.js shebang (`#!/usr/bin/env node`).

## File Operations

Reads hook source directory via `readdirSync(HOOKS_SRC)` filtering for `.js` files excluding `'dist'` entry. Creates `HOOKS_DIST` directory via `mkdirSync()` with `recursive: true` option if missing. Iterates `hookFiles` array executing `copyFileSync(src, dest)` for each entry. Logs copy operations to console with relative path format `hooks/dist/${file}`.

## Path Resolution

Computes `projectRoot` via `join(__dirname, '..')` where `__dirname` derives from `dirname(fileURLToPath(import.meta.url))` pattern for ES module compatibility. Defines `HOOKS_SRC` as `join(projectRoot, 'hooks')` and `HOOKS_DIST` as `join(projectRoot, 'hooks', 'dist')`.

## Target Files

Processes hook scripts from hooks/ directory: `are-check-update.js`, `are-session-end.js`, `opencode-are-check-update.js`, `opencode-are-session-end.js`. Filter predicate `f.endsWith('.js') && f !== 'dist'` prevents recursion into output directory.

## Integration with Build Pipeline

Bundled hooks consumed by `src/installer/operations.ts` during IDE command/hook installation. Output directory `hooks/dist/` included in npm tarball via package.json files configuration ensuring hook scripts ship with published package.