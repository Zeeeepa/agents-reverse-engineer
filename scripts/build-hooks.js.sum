---
generated_at: 2026-02-09T17:46:17.929Z
content_hash: a40783828dd9498fd985c6549a5633cdcc281a734dbad7cd209d46861ee350be
purpose: build-hooks.js copies hook source files from hooks/ to hooks/dist/ for npm package distribution during prepublishOnly...
---
**build-hooks.js copies hook source files from hooks/ to hooks/dist/ for npm package distribution during prepublishOnly lifecycle.**

## Execution Context

Invoked via `npm run build:hooks` or automatically during `npm run prepublishOnly`. Runs as standalone Node.js script with `#!/usr/bin/env node` shebang.

## File Operations

Resolves `projectRoot` via `fileURLToPath(import.meta.url)` and `dirname(__dirname)` to compute absolute paths. Defines `HOOKS_SRC = join(projectRoot, 'hooks')` and `HOOKS_DIST = join(projectRoot, 'hooks', 'dist')`.

Creates `HOOKS_DIST` directory via `mkdirSync(HOOKS_DIST, { recursive: true })` if not present via `existsSync()` check.

Filters hook files using `readdirSync(HOOKS_SRC).filter(f => f.endsWith('.js') && f !== 'dist')` to exclude `dist` directory itself and non-JavaScript files. Copies each filtered file via `copyFileSync(join(HOOKS_SRC, file), join(HOOKS_DIST, file))`.

## Console Output

Logs `Building hooks...` header, per-file progress `Copied: ${file} -> hooks/dist/${file}`, and completion summary `Done. ${hookFiles.length} hook(s) built.`.

## Integration Points

Called by package.json `prepublishOnly` script which chains `npm run build && npm run build:hooks`. Ensures hooks/ directory contents (are-check-update.js, are-session-end.js, opencode-are-check-update.js, opencode-are-session-end.js) exist in hooks/dist/ for npm tarball inclusion referenced by installer/operations.ts hook installation logic.