<!-- Generated by agents-reverse-engineer -->

# scripts/

Build automation utilities for npm package distribution. Currently contains a single script that prepares session lifecycle hooks for inclusion in the published npm tarball.

## Contents

**[build-hooks.js](./build-hooks.js)** — Copies `.js` hook files from `hooks/` to `hooks/dist/` via synchronous `copyFileSync()`, filtering non-JS files and the dist directory itself, invoked by `npm run build:hooks` and `prepublishOnly` lifecycle hook.

## Build Pipeline Integration

**Execution trigger:** `build-hooks.js` runs during `npm run prepublishOnly`, which npm automatically invokes before `npm publish`. The package.json `scripts` section chains `prepublishOnly` → `npm run build && npm run build:hooks`, ensuring TypeScript compilation (`tsc`) and hook copying both complete before tarball creation.

**Distribution requirement:** Session lifecycle hooks (`are-check-update.js`, `are-session-end.js`, `opencode-are-check-update.js`, `opencode-are-session-end.js`) must exist in `hooks/dist/` for the npm tarball to include them. The installer module (`src/installer/operations.ts`) copies these files from the installed package into IDE config directories (`~/.claude/hooks/`, `~/.config/opencode/plugins/`).

## File Operations

**Path resolution:** Uses ES module `import.meta.url` → `fileURLToPath()` → `__dirname` pattern to locate project root. Constructs `HOOKS_SRC` as `join(projectRoot, 'hooks')` and `HOOKS_DIST` as `join(projectRoot, 'hooks', 'dist')`.

**Synchronous workflow:**
1. `existsSync(HOOKS_DIST)` checks for dist directory
2. `mkdirSync(HOOKS_DIST, { recursive: true })` creates directory if missing
3. `readdirSync(HOOKS_SRC)` enumerates source files
4. `.filter(f => f.endsWith('.js') && f !== 'dist')` excludes non-JavaScript files and dist directory
5. `copyFileSync(join(HOOKS_SRC, file), join(HOOKS_DIST, file))` copies each hook file
6. Console logs progress: per-file `"Copied: {file} -> hooks/dist/{file}"` and summary `"Done. {count} hook(s) built."`

## Behavioral Contracts

**File filter predicate:** `/\.js$/ && f !== 'dist'` (endsWith check + exclusion)