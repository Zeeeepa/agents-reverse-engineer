---
generated_at: 2026-02-09T15:06:12.924Z
content_hash: 75ab86d0c3fb58954b283b3a7d7248f50fb838f608dd6f39ab0db505acb7d4c8
purpose: publish.yml defines GitHub Actions workflow automating npm package publication with provenance attestation on release...
---
**publish.yml defines GitHub Actions workflow automating npm package publication with provenance attestation on release events or manual dispatch.**

## Workflow Triggers

Activates on two event types via `on` key: `release` with `types: [published]` filter for GitHub release publication, `workflow_dispatch` for manual execution.

## Job Configuration

Single `publish` job runs on `ubuntu-latest` runner with `permissions` granting `contents: read` (repository checkout) and `id-token: write` (provenance attestation signing via OIDC).

## Build Steps

Executes six sequential steps:
1. `actions/checkout@v4` clones repository
2. `actions/setup-node@v4` installs Node.js 20 with `registry-url: 'https://registry.npmjs.org'` for npm authentication
3. `npm ci` installs dependencies from lockfile (clean install)
4. `npm run build` compiles TypeScript via `tsc` and copies hooks via `build:hooks` script (see package.json `prepublishOnly`)
5. `npm publish` pushes package to npm registry with `--provenance` flag (generates cryptographic attestation linking artifact to source commit) and `--access public` (scoped package visibility)
6. `NODE_AUTH_TOKEN` environment variable injects `${{ secrets.NPM_TOKEN }}` GitHub secret for npm authentication

## Provenance Attestation

Provenance flag leverages GitHub's OIDC token (`id-token: write` permission) to generate Sigstore-signed attestation proving package was built from specific commit SHA in CI environment, enabling supply chain verification via `npm audit signatures`.

## Integration Points

Depends on npm token stored in repository secrets (`NPM_TOKEN` key), package.json `prepublishOnly` lifecycle hook executing build steps, and GitHub release creation workflow triggering publication automatically.